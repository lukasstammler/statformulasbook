<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Kapitel 6 Inferenz für quantitative Daten | Formeln Statistik</title>
  <meta name="description" content="Zusammenstellung von Statistik-Formeln mit Beispielen in R für einen Grundkurs Statistik" />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="Kapitel 6 Inferenz für quantitative Daten | Formeln Statistik" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Zusammenstellung von Statistik-Formeln mit Beispielen in R für einen Grundkurs Statistik" />
  <meta name="github-repo" content="lukasstammler/statformulasbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Kapitel 6 Inferenz für quantitative Daten | Formeln Statistik" />
  
  <meta name="twitter:description" content="Zusammenstellung von Statistik-Formeln mit Beispielen in R für einen Grundkurs Statistik" />
  

<meta name="author" content="Lukas Stammler" />


<meta name="date" content="2022-04-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="grundlagen-der-inferenzstatistik.html"/>
<link rel="next" href="inferenz-für-qualitative-daten.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Vorbemerkung<span></span></a></li>
<li class="chapter" data-level="2" data-path="Deskriptive.html"><a href="Deskriptive.html"><i class="fa fa-check"></i><b>2</b> Deskriptive Statistik<span></span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="Deskriptive.html"><a href="Deskriptive.html#kennzahlen-der-zentralen-tendenz-und-der-streuung"><i class="fa fa-check"></i><b>2.1</b> Kennzahlen der zentralen Tendenz und der Streuung<span></span></a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="Deskriptive.html"><a href="Deskriptive.html#umfang"><i class="fa fa-check"></i><b>2.1.1</b> Umfang<span></span></a></li>
<li class="chapter" data-level="2.1.2" data-path="Deskriptive.html"><a href="Deskriptive.html#arithmetisches-mittel-mittelwert"><i class="fa fa-check"></i><b>2.1.2</b> Arithmetisches Mittel, Mittelwert<span></span></a></li>
<li class="chapter" data-level="2.1.3" data-path="Deskriptive.html"><a href="Deskriptive.html#median"><i class="fa fa-check"></i><b>2.1.3</b> Median<span></span></a></li>
<li class="chapter" data-level="2.1.4" data-path="Deskriptive.html"><a href="Deskriptive.html#varianz"><i class="fa fa-check"></i><b>2.1.4</b> Varianz<span></span></a></li>
<li class="chapter" data-level="2.1.5" data-path="Deskriptive.html"><a href="Deskriptive.html#standardabweichung"><i class="fa fa-check"></i><b>2.1.5</b> Standardabweichung<span></span></a></li>
<li class="chapter" data-level="2.1.6" data-path="Deskriptive.html"><a href="Deskriptive.html#minimum-maximum-und-variationsbreite"><i class="fa fa-check"></i><b>2.1.6</b> Minimum, Maximum und Variationsbreite<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="Deskriptive.html"><a href="Deskriptive.html#grafiken"><i class="fa fa-check"></i><b>2.2</b> Grafiken<span></span></a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="Deskriptive.html"><a href="Deskriptive.html#histogramm"><i class="fa fa-check"></i><b>2.2.1</b> Histogramm<span></span></a></li>
<li class="chapter" data-level="2.2.2" data-path="Deskriptive.html"><a href="Deskriptive.html#boxplot"><i class="fa fa-check"></i><b>2.2.2</b> Boxplot<span></span></a></li>
<li class="chapter" data-level="2.2.3" data-path="Deskriptive.html"><a href="Deskriptive.html#balkendiagramm"><i class="fa fa-check"></i><b>2.2.3</b> Balkendiagramm<span></span></a></li>
<li class="chapter" data-level="2.2.4" data-path="Deskriptive.html"><a href="Deskriptive.html#tabellen-für-häufigkeiten"><i class="fa fa-check"></i><b>2.2.4</b> Tabellen für Häufigkeiten<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="grundbegriffe-der-wahrscheinlichkeitstheorie.html"><a href="grundbegriffe-der-wahrscheinlichkeitstheorie.html"><i class="fa fa-check"></i><b>3</b> Grundbegriffe der Wahrscheinlichkeitstheorie<span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="grundbegriffe-der-wahrscheinlichkeitstheorie.html"><a href="grundbegriffe-der-wahrscheinlichkeitstheorie.html#wahrscheinlichkeit"><i class="fa fa-check"></i><b>3.1</b> Wahrscheinlichkeit<span></span></a></li>
<li class="chapter" data-level="3.2" data-path="grundbegriffe-der-wahrscheinlichkeitstheorie.html"><a href="grundbegriffe-der-wahrscheinlichkeitstheorie.html#ereignis-und-komplementärereignis"><i class="fa fa-check"></i><b>3.2</b> Ereignis und Komplementärereignis<span></span></a></li>
<li class="chapter" data-level="3.3" data-path="grundbegriffe-der-wahrscheinlichkeitstheorie.html"><a href="grundbegriffe-der-wahrscheinlichkeitstheorie.html#disjunkte-ereignisse"><i class="fa fa-check"></i><b>3.3</b> Disjunkte Ereignisse<span></span></a></li>
<li class="chapter" data-level="3.4" data-path="grundbegriffe-der-wahrscheinlichkeitstheorie.html"><a href="grundbegriffe-der-wahrscheinlichkeitstheorie.html#nicht-disjunkte-ereignisse"><i class="fa fa-check"></i><b>3.4</b> Nicht-disjunkte Ereignisse<span></span></a></li>
<li class="chapter" data-level="3.5" data-path="grundbegriffe-der-wahrscheinlichkeitstheorie.html"><a href="grundbegriffe-der-wahrscheinlichkeitstheorie.html#bedingte-wahrscheinlichkeiten"><i class="fa fa-check"></i><b>3.5</b> Bedingte Wahrscheinlichkeiten<span></span></a></li>
<li class="chapter" data-level="3.6" data-path="grundbegriffe-der-wahrscheinlichkeitstheorie.html"><a href="grundbegriffe-der-wahrscheinlichkeitstheorie.html#unabhängigkeit"><i class="fa fa-check"></i><b>3.6</b> Unabhängigkeit<span></span></a></li>
<li class="chapter" data-level="3.7" data-path="grundbegriffe-der-wahrscheinlichkeitstheorie.html"><a href="grundbegriffe-der-wahrscheinlichkeitstheorie.html#theorem-von-bayes"><i class="fa fa-check"></i><b>3.7</b> Theorem von Bayes<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="wahrscheinlichkeitsverteilungen.html"><a href="wahrscheinlichkeitsverteilungen.html"><i class="fa fa-check"></i><b>4</b> Wahrscheinlichkeitsverteilungen<span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="wahrscheinlichkeitsverteilungen.html"><a href="wahrscheinlichkeitsverteilungen.html#binomialverteilung"><i class="fa fa-check"></i><b>4.1</b> Binomialverteilung<span></span></a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="wahrscheinlichkeitsverteilungen.html"><a href="wahrscheinlichkeitsverteilungen.html#voraussetzungen"><i class="fa fa-check"></i><b>4.1.1</b> Voraussetzungen<span></span></a></li>
<li class="chapter" data-level="4.1.2" data-path="wahrscheinlichkeitsverteilungen.html"><a href="wahrscheinlichkeitsverteilungen.html#funktion-der-binomialverteilung"><i class="fa fa-check"></i><b>4.1.2</b> Funktion der Binomialverteilung<span></span></a></li>
<li class="chapter" data-level="4.1.3" data-path="wahrscheinlichkeitsverteilungen.html"><a href="wahrscheinlichkeitsverteilungen.html#binomialkoeffizient"><i class="fa fa-check"></i><b>4.1.3</b> Binomialkoeffizient<span></span></a></li>
<li class="chapter" data-level="4.1.4" data-path="wahrscheinlichkeitsverteilungen.html"><a href="wahrscheinlichkeitsverteilungen.html#eigenschaften-der-binomialverteilung"><i class="fa fa-check"></i><b>4.1.4</b> Eigenschaften der Binomialverteilung<span></span></a></li>
<li class="chapter" data-level="4.1.5" data-path="wahrscheinlichkeitsverteilungen.html"><a href="wahrscheinlichkeitsverteilungen.html#normalapproximation"><i class="fa fa-check"></i><b>4.1.5</b> Normalapproximation<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="wahrscheinlichkeitsverteilungen.html"><a href="wahrscheinlichkeitsverteilungen.html#normalverteilung"><i class="fa fa-check"></i><b>4.2</b> Normalverteilung<span></span></a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="wahrscheinlichkeitsverteilungen.html"><a href="wahrscheinlichkeitsverteilungen.html#regel"><i class="fa fa-check"></i><b>4.2.1</b> 68-95-99.7-Regel<span></span></a></li>
<li class="chapter" data-level="4.2.2" data-path="wahrscheinlichkeitsverteilungen.html"><a href="wahrscheinlichkeitsverteilungen.html#standardnormalverteilung"><i class="fa fa-check"></i><b>4.2.2</b> Standardnormalverteilung<span></span></a></li>
<li class="chapter" data-level="4.2.3" data-path="wahrscheinlichkeitsverteilungen.html"><a href="wahrscheinlichkeitsverteilungen.html#z-wert"><i class="fa fa-check"></i><b>4.2.3</b> z-Wert<span></span></a></li>
<li class="chapter" data-level="4.2.4" data-path="wahrscheinlichkeitsverteilungen.html"><a href="wahrscheinlichkeitsverteilungen.html#wahrscheinlichkeiten-und-perzentilen-in-r-berechnen"><i class="fa fa-check"></i><b>4.2.4</b> Wahrscheinlichkeiten und Perzentilen in <code>R</code> berechnen<span></span></a></li>
<li class="chapter" data-level="4.2.5" data-path="wahrscheinlichkeitsverteilungen.html"><a href="wahrscheinlichkeitsverteilungen.html#qq-plot"><i class="fa fa-check"></i><b>4.2.5</b> QQ-Plot<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="wahrscheinlichkeitsverteilungen.html"><a href="wahrscheinlichkeitsverteilungen.html#t-verteilung"><i class="fa fa-check"></i><b>4.3</b> T-Verteilung<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="grundlagen-der-inferenzstatistik.html"><a href="grundlagen-der-inferenzstatistik.html"><i class="fa fa-check"></i><b>5</b> Grundlagen der Inferenzstatistik<span></span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="grundlagen-der-inferenzstatistik.html"><a href="grundlagen-der-inferenzstatistik.html#schätzungen-von-parametern"><i class="fa fa-check"></i><b>5.1</b> Schätzungen von Parametern<span></span></a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="grundlagen-der-inferenzstatistik.html"><a href="grundlagen-der-inferenzstatistik.html#schätzung-bei-qualitativen-merkmalen"><i class="fa fa-check"></i><b>5.1.1</b> Schätzung bei qualitativen Merkmalen<span></span></a></li>
<li class="chapter" data-level="5.1.2" data-path="grundlagen-der-inferenzstatistik.html"><a href="grundlagen-der-inferenzstatistik.html#schätzung-bei-quantitativen-merkmalen"><i class="fa fa-check"></i><b>5.1.2</b> Schätzung bei quantitativen Merkmalen<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="grundlagen-der-inferenzstatistik.html"><a href="grundlagen-der-inferenzstatistik.html#hypothesentest-für-einen-mittelwert"><i class="fa fa-check"></i><b>5.2</b> Hypothesentest für einen Mittelwert<span></span></a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="grundlagen-der-inferenzstatistik.html"><a href="grundlagen-der-inferenzstatistik.html#vorgehen"><i class="fa fa-check"></i><b>5.2.1</b> Vorgehen<span></span></a></li>
<li class="chapter" data-level="5.2.2" data-path="grundlagen-der-inferenzstatistik.html"><a href="grundlagen-der-inferenzstatistik.html#p-werte-berechnen"><i class="fa fa-check"></i><b>5.2.2</b> p-Werte berechnen<span></span></a></li>
<li class="chapter" data-level="5.2.3" data-path="grundlagen-der-inferenzstatistik.html"><a href="grundlagen-der-inferenzstatistik.html#entscheidungsfehler"><i class="fa fa-check"></i><b>5.2.3</b> Entscheidungsfehler<span></span></a></li>
<li class="chapter" data-level="5.2.4" data-path="grundlagen-der-inferenzstatistik.html"><a href="grundlagen-der-inferenzstatistik.html#hypothesentests-mit-konfidenzintervallen"><i class="fa fa-check"></i><b>5.2.4</b> Hypothesentests mit Konfidenzintervallen<span></span></a></li>
<li class="chapter" data-level="5.2.5" data-path="grundlagen-der-inferenzstatistik.html"><a href="grundlagen-der-inferenzstatistik.html#vorgehen-1"><i class="fa fa-check"></i><b>5.2.5</b> Vorgehen<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="inferenz-für-quantitative-daten.html"><a href="inferenz-für-quantitative-daten.html"><i class="fa fa-check"></i><b>6</b> Inferenz für quantitative Daten<span></span></a>
<ul>
<li class="chapter" data-level="6.1" data-path="inferenz-für-quantitative-daten.html"><a href="inferenz-für-quantitative-daten.html#parametrische-testverfahren"><i class="fa fa-check"></i><b>6.1</b> Parametrische Testverfahren<span></span></a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="inferenz-für-quantitative-daten.html"><a href="inferenz-für-quantitative-daten.html#z-test"><i class="fa fa-check"></i><b>6.1.1</b> z-Test<span></span></a></li>
<li class="chapter" data-level="6.1.2" data-path="inferenz-für-quantitative-daten.html"><a href="inferenz-für-quantitative-daten.html#einstichproben-t-test"><i class="fa fa-check"></i><b>6.1.2</b> Einstichproben-<span class="math inline">\(t\)</span>-Test<span></span></a></li>
<li class="chapter" data-level="6.1.3" data-path="inferenz-für-quantitative-daten.html"><a href="inferenz-für-quantitative-daten.html#t-test-für-verbundene-stichproben"><i class="fa fa-check"></i><b>6.1.3</b> t-Test für verbundene Stichproben<span></span></a></li>
<li class="chapter" data-level="6.1.4" data-path="inferenz-für-quantitative-daten.html"><a href="inferenz-für-quantitative-daten.html#t-test-für-unabhängige-stichproben"><i class="fa fa-check"></i><b>6.1.4</b> t-Test für unabhängige Stichproben<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="inferenz-für-quantitative-daten.html"><a href="inferenz-für-quantitative-daten.html#nicht-parametrische-testverfahren"><i class="fa fa-check"></i><b>6.2</b> Nicht-parametrische Testverfahren<span></span></a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="inferenz-für-quantitative-daten.html"><a href="inferenz-für-quantitative-daten.html#vorzeichentest"><i class="fa fa-check"></i><b>6.2.1</b> Vorzeichentest<span></span></a></li>
<li class="chapter" data-level="6.2.2" data-path="inferenz-für-quantitative-daten.html"><a href="inferenz-für-quantitative-daten.html#wilcoxon-vorzeichenrangtest"><i class="fa fa-check"></i><b>6.2.2</b> Wilcoxon-Vorzeichenrangtest<span></span></a></li>
<li class="chapter" data-level="6.2.3" data-path="inferenz-für-quantitative-daten.html"><a href="inferenz-für-quantitative-daten.html#mann-whitney-u-test"><i class="fa fa-check"></i><b>6.2.3</b> Mann-Whitney-U-Test<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="inferenz-für-quantitative-daten.html"><a href="inferenz-für-quantitative-daten.html#bootstrap-methode"><i class="fa fa-check"></i><b>6.3</b> Bootstrap-Methode<span></span></a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="inferenz-für-quantitative-daten.html"><a href="inferenz-für-quantitative-daten.html#vorgehen-2"><i class="fa fa-check"></i><b>6.3.1</b> Vorgehen<span></span></a></li>
<li class="chapter" data-level="6.3.2" data-path="inferenz-für-quantitative-daten.html"><a href="inferenz-für-quantitative-daten.html#bootstrapping-in-r"><i class="fa fa-check"></i><b>6.3.2</b> Bootstrapping in <code>R</code><span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="inferenz-für-qualitative-daten.html"><a href="inferenz-für-qualitative-daten.html"><i class="fa fa-check"></i><b>7</b> Inferenz für qualitative Daten<span></span></a>
<ul>
<li class="chapter" data-level="7.1" data-path="inferenz-für-qualitative-daten.html"><a href="inferenz-für-qualitative-daten.html#hypothesentest-für-eine-stichprobe"><i class="fa fa-check"></i><b>7.1</b> Hypothesentest für eine Stichprobe<span></span></a></li>
<li class="chapter" data-level="7.2" data-path="inferenz-für-qualitative-daten.html"><a href="inferenz-für-qualitative-daten.html#vergleich-von-zwei-relativen-häufigkeiten"><i class="fa fa-check"></i><b>7.2</b> Vergleich von zwei relativen Häufigkeiten<span></span></a></li>
<li class="chapter" data-level="7.3" data-path="inferenz-für-qualitative-daten.html"><a href="inferenz-für-qualitative-daten.html#chi-quadrat-test"><i class="fa fa-check"></i><b>7.3</b> Chi-Quadrat-Test<span></span></a></li>
<li class="chapter" data-level="7.4" data-path="inferenz-für-qualitative-daten.html"><a href="inferenz-für-qualitative-daten.html#fishers-exakter-test"><i class="fa fa-check"></i><b>7.4</b> Fisher’s exakter Test<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="korrelation-und-lineare-regression.html"><a href="korrelation-und-lineare-regression.html"><i class="fa fa-check"></i><b>8</b> Korrelation und lineare Regression<span></span></a>
<ul>
<li class="chapter" data-level="8.1" data-path="korrelation-und-lineare-regression.html"><a href="korrelation-und-lineare-regression.html#korrelation"><i class="fa fa-check"></i><b>8.1</b> Korrelation<span></span></a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="korrelation-und-lineare-regression.html"><a href="korrelation-und-lineare-regression.html#korrelationskoeffizient-nach-pearson-r"><i class="fa fa-check"></i><b>8.1.1</b> Korrelationskoeffizient nach Pearson <span class="math inline">\(r\)</span><span></span></a></li>
<li class="chapter" data-level="8.1.2" data-path="korrelation-und-lineare-regression.html"><a href="korrelation-und-lineare-regression.html#rangkorrelationskoeffizient-nach-spearman"><i class="fa fa-check"></i><b>8.1.2</b> Rangkorrelationskoeffizient nach Spearman<span></span></a></li>
<li class="chapter" data-level="8.1.3" data-path="korrelation-und-lineare-regression.html"><a href="korrelation-und-lineare-regression.html#interpretation-korrelationskoeffizienten"><i class="fa fa-check"></i><b>8.1.3</b> Interpretation Korrelationskoeffizienten<span></span></a></li>
<li class="chapter" data-level="8.1.4" data-path="korrelation-und-lineare-regression.html"><a href="korrelation-und-lineare-regression.html#hypothesentest-für-korrelationskoeffizienten"><i class="fa fa-check"></i><b>8.1.4</b> Hypothesentest für Korrelationskoeffizienten<span></span></a></li>
<li class="chapter" data-level="8.1.5" data-path="korrelation-und-lineare-regression.html"><a href="korrelation-und-lineare-regression.html#vertrauensintervall-für-pearsons-r"><i class="fa fa-check"></i><b>8.1.5</b> Vertrauensintervall für Pearson’s r<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="varianzanalyse.html"><a href="varianzanalyse.html"><i class="fa fa-check"></i><b>9</b> Varianzanalyse<span></span></a>
<ul>
<li class="chapter" data-level="9.1" data-path="varianzanalyse.html"><a href="varianzanalyse.html#einfaktorielle-varianzanalyse"><i class="fa fa-check"></i><b>9.1</b> Einfaktorielle Varianzanalyse<span></span></a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="varianzanalyse.html"><a href="varianzanalyse.html#quadratsummenzerlegung"><i class="fa fa-check"></i><b>9.1.1</b> Quadratsummenzerlegung<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="effektgrössen.html"><a href="effektgrössen.html"><i class="fa fa-check"></i><b>10</b> Effektgrössen<span></span></a></li>
<li class="chapter" data-level="11" data-path="referenzen.html"><a href="referenzen.html"><i class="fa fa-check"></i><b>11</b> Referenzen<span></span></a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Formeln Statistik</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="inferenz-für-quantitative-daten" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Kapitel 6</span> Inferenz für quantitative Daten<a href="inferenz-für-quantitative-daten.html#inferenz-für-quantitative-daten" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="parametrische-testverfahren" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Parametrische Testverfahren<a href="inferenz-für-quantitative-daten.html#parametrische-testverfahren" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Parametrische Testverfahren setzen voraus, dass das zu untersuchende Beobachtungsmerkmal aus einer eindeutig definierten Verteilung, meist aus einer Normalverteilung stammt.</p>
<p><strong>Übersicht zur Testwahl</strong></p>
<p>Voraussetzung: Beobachtungsmerkmal stammt aus einer normalverteilten Population.</p>
<p>Eine Stichprobe</p>
<ul>
<li><span class="math inline">\(n &gt; 30 \rightarrow\)</span> <strong>z-Test</strong><br />
</li>
<li><span class="math inline">\(n \leq 30 \rightarrow\)</span> <strong>Einstichproben-t-Test</strong></li>
</ul>
<p>zwei Stichproben</p>
<ul>
<li>verbundene (abhängige) Stichproben <span class="math inline">\(\rightarrow\)</span> <strong>t-Test für verbundene Stichproben</strong><br />
</li>
<li>unabhängige Stichproben <span class="math inline">\(\rightarrow\)</span> <strong>t-Test für unabhängige Stichproben (Welch-Test)</strong></li>
</ul>
<div id="z-test" class="section level3 hasAnchor" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> z-Test<a href="inferenz-für-quantitative-daten.html#z-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Mit dem <span class="math inline">\(z\)</span>-Test vergleichen wir den Mittelwert einer Stichprobe mit einem bekannten
Populationsmittelwert (= Nullwert).</p>
<ol style="list-style-type: decimal">
<li>Hypothesen <span class="math inline">\(H_0\)</span> und <span class="math inline">\(H_A\)</span> formulieren.</li>
</ol>
<ul>
<li><span class="math inline">\(H_0: \mu = Nullwert\)</span><br />
</li>
<li><span class="math inline">\(H_A: \mu \neq Nullwert\)</span></li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li><p>Signifikanzniveau <span class="math inline">\(\alpha\)</span> festlegen (meist <span class="math inline">\(\alpha\)</span> = 0.05).</p></li>
<li><p>Voraussetzungen (Normalverteilung, Stichprobenumfang) für Testwahl prüfen.</p>
<ul>
<li><span class="math inline">\(n \geq 30\)</span></li>
<li>Zufallsstichprobe<br />
</li>
<li>Beobachtungsmerkmal muss quantitativ und annähernd normalverteilt sein.</li>
</ul></li>
<li><p>(1-<span class="math inline">\(\alpha\)</span>)-Konfidenzintervall für Populationsparameter berechnen.</p></li>
</ol>
<p><span class="math display" id="eq:CI-ztest">\[\begin{equation}
  CI_{1-\alpha} = \bar{x} \pm z_{\frac{alpha}{2}} \times SE_{\bar{x}}
  \tag{6.1}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:se-ztest">\[\begin{equation}
  SE_{\bar{x}} = \frac{s}{\sqrt{n}}
  \tag{6.2}
\end{equation}\]</span></p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="inferenz-für-quantitative-daten.html#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># z für Berechnung des CI in R berechnen</span></span>
<span id="cb72-2"><a href="inferenz-für-quantitative-daten.html#cb72-2" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">qnorm</span>(alpha<span class="sc">/</span><span class="dv">2</span>))</span></code></pre></div>
<p>Wenn der Nullwert nicht im (1 - <span class="math inline">\(\alpha\)</span>) Konfidenzintervall enthalten ist, ist der
Unterschied zwischen <span class="math inline">\(\mu\)</span> und Nullwert statistisch signifikant.</p>
<ol start="5" style="list-style-type: decimal">
<li>Teststatistik berechnen.</li>
</ol>
<p><span class="math display" id="eq:z-ztest">\[\begin{equation}
z = \frac{\bar{x} - Nullwert}{SE_{\bar{x}}}
  \tag{6.3}
\end{equation}\]</span></p>
<ol start="6" style="list-style-type: decimal">
<li><span class="math inline">\(p\)</span>-Wert für die Teststatistik berechnen.</li>
</ol>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="inferenz-für-quantitative-daten.html#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># p-Wert für eine zweiseitige Hypothese</span></span>
<span id="cb73-2"><a href="inferenz-für-quantitative-daten.html#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(z)))</span>
<span id="cb73-3"><a href="inferenz-für-quantitative-daten.html#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="inferenz-für-quantitative-daten.html#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="co"># alternativ</span></span>
<span id="cb73-5"><a href="inferenz-für-quantitative-daten.html#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> <span class="fu">pnorm</span>(<span class="sc">-</span><span class="fu">abs</span>(z))</span>
<span id="cb73-6"><a href="inferenz-für-quantitative-daten.html#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(z), <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<ol start="7" style="list-style-type: decimal">
<li><p><span class="math inline">\(p\)</span>-Wert mit Signifikanzniveau vergleichen und Entscheiden ob man <span class="math inline">\(H_0\)</span> verwirft oder beibehält.<br />
Ist der <span class="math inline">\(p\)</span>-Wert kleiner als das Signifikanzniveau <span class="math inline">\(\alpha\)</span>, wird die <span class="math inline">\(H_0\)</span> zu Gunsten der <span class="math inline">\(H_A\)</span> verworfen.</p></li>
<li><p>Ergebnis in allgemein verständlicher Sprache formulieren.</p></li>
</ol>
<p>Beispiel: Bei 30 Personen wurde der Effekt eines Blutdruckmedikaments getestet. Der Hersteller gibt an, dass das Medikament den systolischen Blutdruck im Durchschnitt um 5 mmHg senkt. Der Effekt auf den systolischen Blutdruck wurde in der Variablen <code>BDsys</code> gespeichert.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="inferenz-für-quantitative-daten.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb74-2"><a href="inferenz-für-quantitative-daten.html#cb74-2" aria-hidden="true" tabindex="-1"></a>BDsys <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="at">mean =</span> <span class="sc">-</span><span class="dv">6</span>, <span class="at">sd =</span> <span class="dv">4</span>)  <span class="co"># simulierte Daten generieren  </span></span>
<span id="cb74-3"><a href="inferenz-für-quantitative-daten.html#cb74-3" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span>                          <span class="co"># Signifikanzniveau festlegen</span></span>
<span id="cb74-4"><a href="inferenz-für-quantitative-daten.html#cb74-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-5"><a href="inferenz-für-quantitative-daten.html#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="co"># CI berechnen  </span></span>
<span id="cb74-6"><a href="inferenz-für-quantitative-daten.html#cb74-6" aria-hidden="true" tabindex="-1"></a>mean.BDsys <span class="ot">&lt;-</span> <span class="fu">mean</span>(BDsys)              <span class="co"># Mittelwert für BDsys</span></span>
<span id="cb74-7"><a href="inferenz-für-quantitative-daten.html#cb74-7" aria-hidden="true" tabindex="-1"></a>sd.BDsys <span class="ot">&lt;-</span> <span class="fu">sd</span>(BDsys)                  <span class="co"># Standardabweichung für BDsys</span></span>
<span id="cb74-8"><a href="inferenz-für-quantitative-daten.html#cb74-8" aria-hidden="true" tabindex="-1"></a>n.BDsys <span class="ot">&lt;-</span> <span class="fu">length</span>(BDsys)               <span class="co"># Stichprobenumfang für BDsys</span></span>
<span id="cb74-9"><a href="inferenz-für-quantitative-daten.html#cb74-9" aria-hidden="true" tabindex="-1"></a>SE.BDsys <span class="ot">&lt;-</span> sd.BDsys <span class="sc">/</span> <span class="fu">sqrt</span>(n.BDsys)   <span class="co"># SE für Mittelwert von BDsys    </span></span>
<span id="cb74-10"><a href="inferenz-für-quantitative-daten.html#cb74-10" aria-hidden="true" tabindex="-1"></a>z.CI <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">qnorm</span>(alpha <span class="sc">/</span> <span class="dv">2</span>))          <span class="co"># z-Wert</span></span>
<span id="cb74-11"><a href="inferenz-für-quantitative-daten.html#cb74-11" aria-hidden="true" tabindex="-1"></a>CI <span class="ot">&lt;-</span> mean.BDsys <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">*</span> z.CI <span class="sc">*</span> SE.BDsys  <span class="co">#  Grenzen für CI berechnen</span></span>
<span id="cb74-12"><a href="inferenz-für-quantitative-daten.html#cb74-12" aria-hidden="true" tabindex="-1"></a>CI <span class="ot">&lt;-</span> <span class="fu">round</span>(CI, <span class="dv">3</span>)                     <span class="co"># Werte für CI auf 3 Stellen runden</span></span>
<span id="cb74-13"><a href="inferenz-für-quantitative-daten.html#cb74-13" aria-hidden="true" tabindex="-1"></a>CI.output <span class="ot">&lt;-</span> <span class="fu">paste</span>((<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> <span class="dv">100</span>, <span class="st">&quot;%-CI [&quot;</span>, CI[<span class="dv">1</span>], <span class="st">&quot;, &quot;</span>, CI[<span class="dv">2</span>], <span class="st">&quot;]&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb74-14"><a href="inferenz-für-quantitative-daten.html#cb74-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(CI.output)                       <span class="co"># CI ausgeben</span></span></code></pre></div>
<pre><code>## [1] &quot;95%-CI [-6.993, -4.347]&quot;</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="inferenz-für-quantitative-daten.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Teststatistik berechnen</span></span>
<span id="cb76-2"><a href="inferenz-für-quantitative-daten.html#cb76-2" aria-hidden="true" tabindex="-1"></a>nullvalue <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">5</span>                        <span class="co"># Nullwert eingeben</span></span>
<span id="cb76-3"><a href="inferenz-für-quantitative-daten.html#cb76-3" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> (mean.BDsys <span class="sc">-</span> nullvalue)<span class="sc">/</span>SE.BDsys <span class="co"># z-Wert berechnen</span></span>
<span id="cb76-4"><a href="inferenz-für-quantitative-daten.html#cb76-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">pnorm</span>(<span class="sc">-</span><span class="fu">abs</span>(z))                <span class="co"># p-Wert für z berechnen  (zweiseitig) </span></span>
<span id="cb76-5"><a href="inferenz-für-quantitative-daten.html#cb76-5" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">round</span>(z, <span class="dv">3</span>)                       <span class="co"># z auf 3 Stellen runden</span></span>
<span id="cb76-6"><a href="inferenz-für-quantitative-daten.html#cb76-6" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">round</span>(p, <span class="dv">4</span>)                       <span class="co"># p-Wert auf 4 Stellen runden</span></span>
<span id="cb76-7"><a href="inferenz-für-quantitative-daten.html#cb76-7" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;z = &quot;</span>, z, <span class="st">&quot;, p = &quot;</span>, p, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)  </span>
<span id="cb76-8"><a href="inferenz-für-quantitative-daten.html#cb76-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<pre><code>## [1] &quot;z = -0.993, p = 0.3207&quot;</code></pre>
<p>Ergebnis in allgemein verständlicher Sprache formulieren: Die Einnahme des Blutdrucksenkers reduziert den systolischen Blutdruck im Durchschnitt um -5.67, 95%-CI [-6.993, -4.347] mmHg. Der vom Hersteller angegebene Wert von durchschnittlich -5 mmHg ist in diesem 95%-Konfidenzintervall enthalten und es liegt keine Evidenz gegen die Nullhypothese (<span class="math inline">\(H_0: \mu = -5\)</span>) vor, <span class="math inline">\(z\)</span> = -0.993, <span class="math inline">\(p\)</span> = 0.3207.</p>
<p><strong>Hinweis:</strong> Für den <span class="math inline">\(z\)</span>-Test existiert keine Funktion in <code>R-base</code>. Zum Überprüfen der
Ergebnisse kann die Funkion <code>z.test()</code> aus dem Package <code>BSDA</code> verwendet werden.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="inferenz-für-quantitative-daten.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;BSDA&quot;</span>)</span>
<span id="cb78-2"><a href="inferenz-für-quantitative-daten.html#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(BSDA)</span>
<span id="cb78-3"><a href="inferenz-für-quantitative-daten.html#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="fu">z.test</span>()                               <span class="co"># für Beschreibung ?z.test eingeben</span></span></code></pre></div>
</div>
<div id="einstichproben-t-test" class="section level3 hasAnchor" number="6.1.2">
<h3><span class="header-section-number">6.1.2</span> Einstichproben-<span class="math inline">\(t\)</span>-Test<a href="inferenz-für-quantitative-daten.html#einstichproben-t-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Wie beim <span class="math inline">\(z\)</span>-Test vergleichen wir den Mittelwert einer Stichprobe mit einem bekannten Populationsmittelwert (= Nullwert). Bei kleinen Stichproben (<span class="math inline">\(n &lt; 30\)</span>) kann der <span class="math inline">\(z\)</span>-Test allerdings nicht angewendet werden und wir verwenden den Einstichproben-<span class="math inline">\(t\)</span>-Test.</p>
<p><strong>Merke: Statistikprogramme wie <code>R</code> verwenden immer den <span class="math inline">\(t\)</span>-Test.</strong></p>
<ol style="list-style-type: decimal">
<li>Hypothesen <span class="math inline">\(H_0\)</span> und <span class="math inline">\(H_A\)</span> formulieren.</li>
</ol>
<ul>
<li><span class="math inline">\(H_0: \mu = Nullwert\)</span><br />
</li>
<li><span class="math inline">\(H_A: \mu \neq Nullwert\)</span></li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li><p>Signifikanzniveau <span class="math inline">\(\alpha\)</span> festlegen (meist <span class="math inline">\(\alpha\)</span> = 0.05).</p></li>
<li><p>Voraussetzungen (Normalverteilung, Stichprobenumfang) für Testwahl prüfen.</p>
<ul>
<li>Zufallsstichprobe<br />
</li>
<li>Beobachtungsmerkmal muss quantitativ und annähernd normalverteilt sein.</li>
</ul></li>
<li><p>(1-<span class="math inline">\(\alpha\)</span>)-Konfidenzintervall für Populationsparameter berechnen.</p></li>
</ol>
<p><span class="math display" id="eq:CI-ttest">\[\begin{equation}
  CI_{1-\alpha} = \bar{x} \pm t_{\frac{\alpha}{2},df} \times SE_{\bar{x}}
  \tag{6.4}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:se-ttest">\[\begin{equation}
  SE_{\bar{x}} = \frac{s}{\sqrt{n}}, ~~ df = n-1
  \tag{6.5}
\end{equation}\]</span></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="inferenz-für-quantitative-daten.html#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># t für Berechnung des CI in R berechnen</span></span>
<span id="cb79-2"><a href="inferenz-für-quantitative-daten.html#cb79-2" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">qt</span>(alpha<span class="sc">/</span><span class="dv">2</span>), <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>)</span></code></pre></div>
<p>Wenn der Nullwert nicht im (1 - <span class="math inline">\(\alpha\)</span>) Konfidenzintervall enthalten ist, ist der
Unterschied zwischen <span class="math inline">\(\mu\)</span> und Nullwert statistisch signifikant.</p>
<ol start="5" style="list-style-type: decimal">
<li>Teststatistik berechnen.</li>
</ol>
<p><span class="math display" id="eq:t-ztest">\[\begin{equation}
  t = \frac{\bar{x} - Nullwert}{SE_{\bar{x}}}
  \tag{6.6}
\end{equation}\]</span></p>
<ol start="6" style="list-style-type: decimal">
<li><span class="math inline">\(p\)</span>-Wert für die Teststatistik berechnen.</li>
</ol>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="inferenz-für-quantitative-daten.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># p-Wert für eine zweiseitige Hypothese</span></span>
<span id="cb80-2"><a href="inferenz-für-quantitative-daten.html#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(<span class="fu">abs</span>(t), <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span> ))</span>
<span id="cb80-3"><a href="inferenz-für-quantitative-daten.html#cb80-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-4"><a href="inferenz-für-quantitative-daten.html#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="co"># alternativ</span></span>
<span id="cb80-5"><a href="inferenz-für-quantitative-daten.html#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> <span class="fu">pt</span>(<span class="sc">-</span><span class="fu">abs</span>(t), <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb80-6"><a href="inferenz-für-quantitative-daten.html#cb80-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> <span class="fu">pt</span>(<span class="fu">abs</span>(t), , <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<ol start="7" style="list-style-type: decimal">
<li><p><span class="math inline">\(p\)</span>-Wert mit Signifikanzniveau vergleichen und Entscheiden ob man <span class="math inline">\(H_0\)</span> verwirft oder beibehält.<br />
Ist der <span class="math inline">\(p\)</span>-Wert kleiner als das Signifikanzniveau <span class="math inline">\(\alpha\)</span>, wird die <span class="math inline">\(H_0\)</span> zu Gunsten der <span class="math inline">\(H_A\)</span> verworfen.</p></li>
<li><p>Ergebnis in allgemein verständlicher Sprache formulieren.</p></li>
</ol>
<p>Beispiel: Bei 12 Personen wurde der Effekt eines Blutdruckmedikaments getestet. Der Hersteller gibt an, dass das Medikament den systolischen Blutdruck im Durchschnitt um 5 mmHg senkt. Der Effekt auf den systolischen Blutdruck wurde in der Variablen <code>BDsys</code> gespeichert.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="inferenz-für-quantitative-daten.html#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb81-2"><a href="inferenz-für-quantitative-daten.html#cb81-2" aria-hidden="true" tabindex="-1"></a>BDsys <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">12</span>, <span class="at">mean =</span> <span class="sc">-</span><span class="dv">6</span>, <span class="at">sd =</span> <span class="dv">4</span>)  <span class="co"># simulierte Daten generieren  </span></span>
<span id="cb81-3"><a href="inferenz-für-quantitative-daten.html#cb81-3" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span>                          <span class="co"># Signifikanzniveau festlegen</span></span>
<span id="cb81-4"><a href="inferenz-für-quantitative-daten.html#cb81-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-5"><a href="inferenz-für-quantitative-daten.html#cb81-5" aria-hidden="true" tabindex="-1"></a><span class="co"># CI berechnen  </span></span>
<span id="cb81-6"><a href="inferenz-für-quantitative-daten.html#cb81-6" aria-hidden="true" tabindex="-1"></a>mean.BDsys <span class="ot">&lt;-</span> <span class="fu">mean</span>(BDsys)              <span class="co"># Mittelwert für BDsys</span></span>
<span id="cb81-7"><a href="inferenz-für-quantitative-daten.html#cb81-7" aria-hidden="true" tabindex="-1"></a>sd.BDsys <span class="ot">&lt;-</span> <span class="fu">sd</span>(BDsys)                  <span class="co"># Standardabweichung für BDsys</span></span>
<span id="cb81-8"><a href="inferenz-für-quantitative-daten.html#cb81-8" aria-hidden="true" tabindex="-1"></a>n.BDsys <span class="ot">&lt;-</span> <span class="fu">length</span>(BDsys)               <span class="co"># Stichprobenumfang für BDsys</span></span>
<span id="cb81-9"><a href="inferenz-für-quantitative-daten.html#cb81-9" aria-hidden="true" tabindex="-1"></a>SE.BDsys <span class="ot">&lt;-</span> sd.BDsys <span class="sc">/</span> <span class="fu">sqrt</span>(n.BDsys)   <span class="co"># SE für Mittelwert von BDsys    </span></span>
<span id="cb81-10"><a href="inferenz-für-quantitative-daten.html#cb81-10" aria-hidden="true" tabindex="-1"></a>t.CI <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">qt</span>(alpha <span class="sc">/</span> <span class="dv">2</span>, <span class="at">df =</span> n.BDsys <span class="sc">-</span> <span class="dv">1</span>))  <span class="co"># t-Wert</span></span>
<span id="cb81-11"><a href="inferenz-für-quantitative-daten.html#cb81-11" aria-hidden="true" tabindex="-1"></a>CI <span class="ot">&lt;-</span> mean.BDsys <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">*</span> t.CI <span class="sc">*</span> SE.BDsys  <span class="co">#  Grenzen für CI berechnen</span></span>
<span id="cb81-12"><a href="inferenz-für-quantitative-daten.html#cb81-12" aria-hidden="true" tabindex="-1"></a>CI <span class="ot">&lt;-</span> <span class="fu">round</span>(CI, <span class="dv">3</span>)                     <span class="co"># Werte für CI auf 3 Stellen runden</span></span>
<span id="cb81-13"><a href="inferenz-für-quantitative-daten.html#cb81-13" aria-hidden="true" tabindex="-1"></a>CI.output <span class="ot">&lt;-</span> <span class="fu">paste</span>((<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> <span class="dv">100</span>, <span class="st">&quot;%-CI [&quot;</span>, CI[<span class="dv">1</span>], <span class="st">&quot;, &quot;</span>, CI[<span class="dv">2</span>], <span class="st">&quot;]&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb81-14"><a href="inferenz-für-quantitative-daten.html#cb81-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(CI.output)                       <span class="co"># CI ausgeben</span></span></code></pre></div>
<pre><code>## [1] &quot;95%-CI [-6.986, -2.865]&quot;</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="inferenz-für-quantitative-daten.html#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Teststatistik berechnen</span></span>
<span id="cb83-2"><a href="inferenz-für-quantitative-daten.html#cb83-2" aria-hidden="true" tabindex="-1"></a>nullvalue <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">5</span>                        <span class="co"># Nullwert eingeben</span></span>
<span id="cb83-3"><a href="inferenz-für-quantitative-daten.html#cb83-3" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> (mean.BDsys <span class="sc">-</span> nullvalue)<span class="sc">/</span>SE.BDsys <span class="co"># z-Wert berechnen</span></span>
<span id="cb83-4"><a href="inferenz-für-quantitative-daten.html#cb83-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">pt</span>(<span class="sc">-</span><span class="fu">abs</span>(t), <span class="at">df =</span> n.BDsys <span class="sc">-</span> <span class="dv">1</span>) <span class="co"># p-Wert für z berechnen  (zweiseitig) </span></span>
<span id="cb83-5"><a href="inferenz-für-quantitative-daten.html#cb83-5" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">round</span>(t, <span class="dv">4</span>)                       <span class="co"># z auf 3 Stellen runden</span></span>
<span id="cb83-6"><a href="inferenz-für-quantitative-daten.html#cb83-6" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">round</span>(p, <span class="dv">4</span>)                       <span class="co"># p-Wert auf 4 Stellen runden</span></span>
<span id="cb83-7"><a href="inferenz-für-quantitative-daten.html#cb83-7" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;t = &quot;</span>, t, <span class="st">&quot;, p = &quot;</span>, p, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)  </span>
<span id="cb83-8"><a href="inferenz-für-quantitative-daten.html#cb83-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<pre><code>## [1] &quot;t = 0.0796, p = 0.938&quot;</code></pre>
<p>Ergebnis in allgemein verständlicher Sprache formulieren: Die Einnahme des Blutdrucksenkers reduziert den systolischen Blutdruck im Durchschnitt um -4.925, 95%-CI [-6.986, -2.865] mmHg. Der vom Hersteller angegebene Wert von durchschnittlich -5 mmHg ist in diesem 95%-Konfidenzintervall enthalten und es liegt keine Evidenz gegen die Nullhypothese (<span class="math inline">\(H_0: \mu = -5\)</span>) vor, <span class="math inline">\(t\)</span> = 0.0796, <span class="math inline">\(df\)</span> = 11, <span class="math inline">\(p\)</span> = 0.938.</p>
<p>Einfacher geht es mit der <code>R</code>-Funktion <code>t.test()</code>.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="inferenz-für-quantitative-daten.html#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(BDsys, <span class="at">mu =</span> <span class="sc">-</span><span class="dv">5</span>)</span></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  BDsys
## t = 0.08, df = 11, p-value = 0.9
## alternative hypothesis: true mean is not equal to -5
## 95 percent confidence interval:
##  -6.986 -2.865
## sample estimates:
## mean of x 
##    -4.925</code></pre>
<p><br/></p>
</div>
<div id="t-test-für-verbundene-stichproben" class="section level3 hasAnchor" number="6.1.3">
<h3><span class="header-section-number">6.1.3</span> t-Test für verbundene Stichproben<a href="inferenz-für-quantitative-daten.html#t-test-für-verbundene-stichproben" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Bei abhängigen Stichproben wird davon ausgegangen, dass die Messwerte in “Paaren” vorliegen, z.B.</p>
<ul>
<li>Gleiche Beobachtungseinheiten: Vorher-Nachher-Messungen, Messwiederholungen<br />
</li>
<li>Unterschiedliche Beobachtungseinheiten (jedoch voneinander abhängig): Zwillingsstudien, Partner, matched pairs.</li>
</ul>
<p>Parameter: <span class="math inline">\(\mu_{\Delta}\)</span> = Mittelwert der paarweisen Differenzen in der Population<br />
Punktschätzer: <span class="math inline">\(\bar{x}_{\Delta}\)</span> = Mittelwert der paarweisen Differenzen in der Stichprobe<br />
Teststatistik: <span class="math inline">\(t\)</span></p>
<ol style="list-style-type: decimal">
<li>Hypothesen <span class="math inline">\(H_0\)</span> und <span class="math inline">\(H_A\)</span> formulieren.</li>
</ol>
<ul>
<li><span class="math inline">\(H_0: \mu_{\Delta} = 0\)</span><br />
</li>
<li><span class="math inline">\(H_A: \mu_{\Delta} \neq 0\)</span> (zweiseitige <span class="math inline">\(H_A\)</span>)</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li><p>Signifikanzniveau <span class="math inline">\(\alpha\)</span> festlegen (meist <span class="math inline">\(\alpha\)</span> = 0.05).</p></li>
<li><p>Voraussetzungen (Normalverteilung, Stichprobenumfang) für Testwahl prüfen.</p></li>
</ol>
<ul>
<li>Zufallsstichprobe<br />
</li>
<li>Paarweise Differenzen sind annähernd normalverteilt.<br />
</li>
<li><span class="math inline">\(n \geq 12\)</span> oder grösser bei stark schiefen Verteilungen</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li>(1-<span class="math inline">\(\alpha\)</span>)-Konfidenzintervall für Populationsparameter berechnen.</li>
</ol>
<p><span class="math display" id="eq:CI-tpaired">\[\begin{equation}
  CI_{1-\alpha} = \bar{x}_{\Delta} \pm t_{\frac{\alpha}{2}, df} \times SE_{\bar{x}_{\Delta}}
  \tag{6.7}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:se-tpaired">\[\begin{equation}
  SE_{\bar{x}_{\Delta}} = \frac{s_{\Delta}}{\sqrt{n}}, ~~ df = n-1
  \tag{6.8}
\end{equation}\]</span></p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="inferenz-für-quantitative-daten.html#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># t für Berechnung des CI in R berechnen</span></span>
<span id="cb87-2"><a href="inferenz-für-quantitative-daten.html#cb87-2" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">qt</span>(alpha<span class="sc">/</span><span class="dv">2</span>), <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>)</span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>Teststatistik berechnen.</li>
</ol>
<p><span class="math display" id="eq:t-paired">\[\begin{equation}
  t = \frac{\bar{x}_{\Delta} - 0}{SE_{\bar{x}_{\Delta}}}
  \tag{6.9}
\end{equation}\]</span></p>
<ol start="6" style="list-style-type: decimal">
<li><span class="math inline">\(p\)</span>-Wert für die Teststatisik berechnen.</li>
</ol>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="inferenz-für-quantitative-daten.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># p-Wert für eine zweiseitige Hypothese</span></span>
<span id="cb88-2"><a href="inferenz-für-quantitative-daten.html#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(<span class="fu">abs</span>(t), <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span> ))</span>
<span id="cb88-3"><a href="inferenz-für-quantitative-daten.html#cb88-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-4"><a href="inferenz-für-quantitative-daten.html#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="co"># alternativ</span></span>
<span id="cb88-5"><a href="inferenz-für-quantitative-daten.html#cb88-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> <span class="fu">pt</span>(<span class="sc">-</span><span class="fu">abs</span>(t), <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb88-6"><a href="inferenz-für-quantitative-daten.html#cb88-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> <span class="fu">pt</span>(<span class="fu">abs</span>(t), , <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<ol start="7" style="list-style-type: decimal">
<li><p><span class="math inline">\(p\)</span>-Wert mit Signifikanzniveau vergleichen und Entscheiden ob man <span class="math inline">\(H_0\)</span> verwirft oder beibehält.<br />
Ist der <span class="math inline">\(p\)</span>-Wert kleiner als das Signifikanzniveau <span class="math inline">\(\alpha\)</span>, wird die <span class="math inline">\(H_0\)</span> zu Gunsten der <span class="math inline">\(H_A\)</span> verworfen.</p></li>
<li><p>Ergebnis in allgemein verständlicher Sprache formulieren.</p></li>
</ol>
<p>Beispiel: Körpergewicht in kg für 17 Probandinnen vor und nach einer Anorexie Therapie. Hat die Therapie einen signifikanten Effekt?</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="inferenz-für-quantitative-daten.html#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="do">## create dataset (data extracted &amp; converted from package PairedData::Anorexia)</span></span>
<span id="cb89-2"><a href="inferenz-für-quantitative-daten.html#cb89-2" aria-hidden="true" tabindex="-1"></a>anorexia <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb89-3"><a href="inferenz-für-quantitative-daten.html#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">1</span>, <span class="at">to =</span> <span class="dv">17</span>, <span class="at">by =</span> <span class="dv">1</span>),</span>
<span id="cb89-4"><a href="inferenz-für-quantitative-daten.html#cb89-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">vor =</span> <span class="fu">c</span>(<span class="fl">38.0</span>, <span class="fl">37.8</span>, <span class="fl">39.0</span>, <span class="fl">37.4</span>, <span class="fl">39.3</span>, <span class="fl">36.1</span>, <span class="fl">34.9</span>, <span class="fl">42.7</span>, <span class="fl">33.3</span>, <span class="fl">36.5</span>, <span class="fl">37.0</span>, <span class="fl">37.2</span>, <span class="fl">35.2</span>, <span class="fl">37.9</span>, <span class="fl">40.8</span>, <span class="fl">39.0</span>, <span class="fl">39.6</span>),</span>
<span id="cb89-5"><a href="inferenz-für-quantitative-daten.html#cb89-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">nach =</span> <span class="fu">c</span>(<span class="fl">43.2</span>, <span class="fl">42.8</span>, <span class="fl">41.5</span>, <span class="fl">41.7</span>, <span class="fl">45.5</span>, <span class="fl">34.8</span>, <span class="fl">34.8</span>, <span class="fl">46.1</span>, <span class="fl">43.0</span>, <span class="fl">34.1</span>, <span class="fl">35.3</span>, <span class="fl">43.3</span>, <span class="fl">41.1</span>, <span class="fl">42.0</span>, <span class="fl">42.5</span>, <span class="fl">41.6</span>, <span class="fl">44.5</span>)</span>
<span id="cb89-6"><a href="inferenz-für-quantitative-daten.html#cb89-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb89-7"><a href="inferenz-für-quantitative-daten.html#cb89-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-8"><a href="inferenz-für-quantitative-daten.html#cb89-8" aria-hidden="true" tabindex="-1"></a><span class="co"># erste 6 Beobachtungseinheiten im Datensatz anzeigen</span></span>
<span id="cb89-9"><a href="inferenz-für-quantitative-daten.html#cb89-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(anorexia)</span></code></pre></div>
<pre><code>##   id  vor nach
## 1  1 38.0 43.2
## 2  2 37.8 42.8
## 3  3 39.0 41.5
## 4  4 37.4 41.7
## 5  5 39.3 45.5
## 6  6 36.1 34.8</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="inferenz-für-quantitative-daten.html#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># paarweise Differenzen berechnen und in Variable anorexia$diff speichern</span></span>
<span id="cb91-2"><a href="inferenz-für-quantitative-daten.html#cb91-2" aria-hidden="true" tabindex="-1"></a>anorexia<span class="sc">$</span>diff <span class="ot">&lt;-</span> anorexia<span class="sc">$</span>nach <span class="sc">-</span> anorexia<span class="sc">$</span>vor</span>
<span id="cb91-3"><a href="inferenz-für-quantitative-daten.html#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(anorexia)</span></code></pre></div>
<pre><code>##   id  vor nach diff
## 1  1 38.0 43.2  5.2
## 2  2 37.8 42.8  5.0
## 3  3 39.0 41.5  2.5
## 4  4 37.4 41.7  4.3
## 5  5 39.3 45.5  6.2
## 6  6 36.1 34.8 -1.3</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="inferenz-für-quantitative-daten.html#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Verteilung der paarweisen Differenzen prüfen --------------------------------</span></span>
<span id="cb93-2"><a href="inferenz-für-quantitative-daten.html#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(anorexia<span class="sc">$</span>diff)              <span class="co"># QQ-Plot erstellen </span></span>
<span id="cb93-3"><a href="inferenz-für-quantitative-daten.html#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(anorexia<span class="sc">$</span>diff)</span></code></pre></div>
<p><img src="statformulasbook_files/figure-html/unnamed-chunk-24-1.png" width="384" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="inferenz-für-quantitative-daten.html#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="do">## CI für anorexia$diff berechnen ----------------------------------------------</span></span>
<span id="cb94-2"><a href="inferenz-für-quantitative-daten.html#cb94-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span>                      <span class="co"># Signifikanzniveau festlegen  </span></span>
<span id="cb94-3"><a href="inferenz-für-quantitative-daten.html#cb94-3" aria-hidden="true" tabindex="-1"></a>mean.diff <span class="ot">&lt;-</span> <span class="fu">mean</span>(anorexia<span class="sc">$</span>diff)   <span class="co"># Mittelwert der paarweisen Differenzen</span></span>
<span id="cb94-4"><a href="inferenz-für-quantitative-daten.html#cb94-4" aria-hidden="true" tabindex="-1"></a>sd.diff <span class="ot">&lt;-</span> <span class="fu">sd</span>(anorexia<span class="sc">$</span>diff)       <span class="co"># Standardabweichung der paarweisen Differenzen</span></span>
<span id="cb94-5"><a href="inferenz-für-quantitative-daten.html#cb94-5" aria-hidden="true" tabindex="-1"></a>n.diff <span class="ot">&lt;-</span> <span class="fu">length</span>(anorexia<span class="sc">$</span>diff)    <span class="co"># Stichprobenumfang ermitteln</span></span>
<span id="cb94-6"><a href="inferenz-für-quantitative-daten.html#cb94-6" aria-hidden="true" tabindex="-1"></a>SE.diff <span class="ot">&lt;-</span> sd.diff<span class="sc">/</span><span class="fu">sqrt</span>(n.diff)    <span class="co"># Standardfehler berechnen  </span></span>
<span id="cb94-7"><a href="inferenz-für-quantitative-daten.html#cb94-7" aria-hidden="true" tabindex="-1"></a>t.CI <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">qt</span>(alpha <span class="sc">/</span> <span class="dv">2</span>, <span class="at">df =</span> n.diff <span class="sc">-</span> <span class="dv">1</span>)) <span class="co"># t für CI-Berechnung bestimmen  </span></span>
<span id="cb94-8"><a href="inferenz-für-quantitative-daten.html#cb94-8" aria-hidden="true" tabindex="-1"></a>CI.diff <span class="ot">&lt;-</span> mean.diff <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">*</span> t.CI <span class="sc">*</span> SE.diff <span class="co"># CI Grenzen berechnen  </span></span>
<span id="cb94-9"><a href="inferenz-für-quantitative-daten.html#cb94-9" aria-hidden="true" tabindex="-1"></a>CI.diff <span class="ot">&lt;-</span> <span class="fu">round</span>(CI.diff, <span class="dv">3</span>)                  <span class="co"># CI-Grenzen auf drei Stellen runden</span></span>
<span id="cb94-10"><a href="inferenz-für-quantitative-daten.html#cb94-10" aria-hidden="true" tabindex="-1"></a>CI.output <span class="ot">&lt;-</span> <span class="fu">paste</span>((<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> <span class="dv">100</span>, <span class="st">&quot;%-CI [&quot;</span>, CI.diff[<span class="dv">1</span>], <span class="st">&quot;, &quot;</span>, CI.diff[<span class="dv">2</span>], <span class="st">&quot;]&quot;</span>)</span>
<span id="cb94-11"><a href="inferenz-für-quantitative-daten.html#cb94-11" aria-hidden="true" tabindex="-1"></a>CI.output</span></code></pre></div>
<pre><code>## [1] &quot;95 %-CI [ 1.631 ,  4.969 ]&quot;</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="inferenz-für-quantitative-daten.html#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="do">## p-Wert bestimmen</span></span>
<span id="cb96-2"><a href="inferenz-für-quantitative-daten.html#cb96-2" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> (mean.diff <span class="sc">-</span> <span class="dv">0</span>) <span class="sc">/</span> SE.diff</span>
<span id="cb96-3"><a href="inferenz-für-quantitative-daten.html#cb96-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">pt</span>(<span class="sc">-</span><span class="fu">abs</span>(t), <span class="at">df =</span> n.diff <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb96-4"><a href="inferenz-für-quantitative-daten.html#cb96-4" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">round</span>(t, <span class="dv">4</span>)</span>
<span id="cb96-5"><a href="inferenz-für-quantitative-daten.html#cb96-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">round</span>(p, <span class="dv">4</span>)</span>
<span id="cb96-6"><a href="inferenz-für-quantitative-daten.html#cb96-6" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;t = &quot;</span>, t, <span class="st">&quot;, p = &quot;</span>, p, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)  </span>
<span id="cb96-7"><a href="inferenz-für-quantitative-daten.html#cb96-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<pre><code>## [1] &quot;t = 4.1917, p = 0.0007&quot;</code></pre>
<p>Ergebnis in allgemein verständlicher Sprache formulieren: Die Therapie führt bei anorektischen Patientinnen im Durchschnitt zu einer signifikanten Gewichtszunahme von 3.3 kg 95 %-CI [ 1.631 , 4.969 ], <span class="math inline">\(t\)</span> = 4.1917, <span class="math inline">\(df\)</span> = 16, <span class="math inline">\(p\)</span> = 0.0007</p>
<p>Einfacher geht es mit der <code>R</code>-Funktion <code>t.test()</code>.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="inferenz-für-quantitative-daten.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(anorexia<span class="sc">$</span>nach, anorexia<span class="sc">$</span>vor, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## 
##  Paired t-test
## 
## data:  anorexia$nach and anorexia$vor
## t = 4.2, df = 16, p-value = 0.0007
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  1.631 4.969
## sample estimates:
## mean of the differences 
##                     3.3</code></pre>
<p><br/></p>
</div>
<div id="t-test-für-unabhängige-stichproben" class="section level3 hasAnchor" number="6.1.4">
<h3><span class="header-section-number">6.1.4</span> t-Test für unabhängige Stichproben<a href="inferenz-für-quantitative-daten.html#t-test-für-unabhängige-stichproben" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Der <span class="math inline">\(t\)</span>-Test dient der Prüfung von Mittelwertsdifferenzen zweier unabhängiger Stichproben (Unterschiedliche Beobachtungseinheiten, z.B. Vergleich von zwei Gruppen).</p>
<ul>
<li>Parameter: <span class="math inline">\(\mu_1 - \mu_2\)</span>, z.B. Differenz der Mittelwerte von zwei Populationen<br />
</li>
<li>Punktschätzer: <span class="math inline">\(\bar{x}_1 - \bar{x}_2\)</span> z.B. Differenz der Mittelwerte von zwei Stichproben<br />
</li>
<li>Teststatistik: <span class="math inline">\(t\)</span></li>
</ul>
<ol style="list-style-type: decimal">
<li>Hypothesen:</li>
</ol>
<ul>
<li><span class="math inline">\(H_0: \mu_1 = \mu_2\)</span> bzw. <span class="math inline">\(H_0: \mu_1 - \mu_2 = 0\)</span><br />
</li>
<li><span class="math inline">\(H_A: \mu_1 \neq \mu_2\)</span> bzw. <span class="math inline">\(H_A: \mu_1 - \mu_2 \neq 0\)</span> (zweiseitige <span class="math inline">\(H_A\)</span>)</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li><p>Signifikanzniveau <span class="math inline">\(\alpha\)</span> festlegen (meist <span class="math inline">\(\alpha\)</span> = 0.05).</p></li>
<li><p>Voraussetzungen (Normalverteilung, Stichprobenumfang) für Testwahl prüfen.</p></li>
</ol>
<ul>
<li>Daten stammen aus zwei unabhängigen Zufallsstichproben.<br />
</li>
<li>Die Daten in beiden Zufallsstichproben sind annähernd normalverteilt.</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li>(1-<span class="math inline">\(\alpha\)</span>)-Konfidenzintervall für Populationsparameter berechnen.</li>
</ol>
<p><span class="math display" id="eq:ci-tindep">\[\begin{equation}
   CI_{1-\alpha} = (\bar{x}_1 - \bar{x}_2) \pm t_{\frac{\alpha}{2},df} \times SE_{\bar{x}_1 - \bar{x}_2}
   \tag{6.10}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:df-indep">\[\begin{equation}
  df = n_1 + n_2 - 2
  \tag{6.11}
\end{equation}\]</span></p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="inferenz-für-quantitative-daten.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># t für Berechnung des CI in R berechnen</span></span>
<span id="cb100-2"><a href="inferenz-für-quantitative-daten.html#cb100-2" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">qt</span>(alpha<span class="sc">/</span><span class="dv">2</span>), <span class="at">df =</span> n1 <span class="sc">+</span> n2 <span class="sc">-</span> <span class="dv">2</span>)</span></code></pre></div>
<ul>
<li><span class="math inline">\(SE\)</span> vereinfacht (für Berechnungen von Hand)</li>
</ul>
<p><span class="math display" id="eq:se-indep-simple">\[\begin{equation}
  SE_{\bar{x}_1 - \bar{x}_2} = \sqrt{\frac{s_1^2}{n_1}+\frac{s_2^2}{n_2}} = \sqrt{SE^2_{\bar{x}_1} + SE^2_{\bar{x}_2}}
  \tag{6.12}
\end{equation}\]</span></p>
<ul>
<li>Gepoolte Standardabweichung</li>
</ul>
<p><span class="math display" id="eq:s-pooled">\[\begin{equation}
  s_{pooled} = \sqrt{\frac{(n_1-1) \cdot s_1^2+(n_2-1) \cdot s_2^2}{n_1+n_2-2}}$
  \tag{6.13}
\end{equation}\]</span></p>
<ul>
<li><span class="math inline">\(SE\)</span> für eine Mittelwertsdifferenz</li>
</ul>
<p><span class="math display" id="eq:se-indep-compl">\[\begin{equation}
  SE_{\bar{x}_1 - \bar{x}_2} = s_{pooled} \cdot \sqrt{\frac{1}{n_1}+\frac{1}{n_2}}
  \tag{6.14}
\end{equation}\]</span></p>
<ol start="5" style="list-style-type: decimal">
<li>Teststatistik berechnen.</li>
</ol>
<p><span class="math display" id="eq:t-tindep">\[\begin{equation}
  t = \frac{\bar{x}_1 - \bar{x}_2}{SE_{\bar{x}_1 - \bar{x}_2}}
  \tag{6.15}  
\end{equation}\]</span></p>
<ol start="6" style="list-style-type: decimal">
<li><span class="math inline">\(p\)</span>-Wert für die Teststatisik berechnen.</li>
</ol>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="inferenz-für-quantitative-daten.html#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># p-Wert für eine zweiseitige Hypothese</span></span>
<span id="cb101-2"><a href="inferenz-für-quantitative-daten.html#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(<span class="fu">abs</span>(t), <span class="at">df =</span> n1 <span class="sc">+</span> n2 <span class="sc">-</span> <span class="dv">2</span>))</span>
<span id="cb101-3"><a href="inferenz-für-quantitative-daten.html#cb101-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-4"><a href="inferenz-für-quantitative-daten.html#cb101-4" aria-hidden="true" tabindex="-1"></a><span class="co"># alternativ</span></span>
<span id="cb101-5"><a href="inferenz-für-quantitative-daten.html#cb101-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> <span class="fu">pt</span>(<span class="sc">-</span><span class="fu">abs</span>(t), <span class="at">df =</span> n1 <span class="sc">+</span> n2 <span class="sc">-</span> <span class="dv">2</span>)</span>
<span id="cb101-6"><a href="inferenz-für-quantitative-daten.html#cb101-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> <span class="fu">pt</span>(<span class="fu">abs</span>(t), , <span class="at">df =</span> n1 <span class="sc">+</span> n2 <span class="sc">-</span> <span class="dv">2</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<ol start="7" style="list-style-type: decimal">
<li><p><span class="math inline">\(p\)</span>-Wert mit Signifikanzniveau vergleichen und Entscheiden ob man <span class="math inline">\(H_0\)</span> verwirft oder beibehält.
Ist der <span class="math inline">\(p\)</span>-Wert kleiner als das Signifikanzniveau <span class="math inline">\(\alpha\)</span>, wird die <span class="math inline">\(H_0\)</span> zu Gunsten der <span class="math inline">\(H_A\)</span> verworfen.</p></li>
<li><p>Ergebnis in allgemein verständlicher Sprache formulieren.</p></li>
</ol>
<p>Beispiel: Unterscheiden sich Studierende, die mit der Methode A lernen in ihrem Gesamtscore von Studierenden, die mit der Methode B lernen?</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="inferenz-für-quantitative-daten.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulierte Daten erzeugen ----------------------------------------------------</span></span>
<span id="cb102-2"><a href="inferenz-für-quantitative-daten.html#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb102-3"><a href="inferenz-für-quantitative-daten.html#cb102-3" aria-hidden="true" tabindex="-1"></a>score <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb102-4"><a href="inferenz-für-quantitative-daten.html#cb102-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">1</span>, <span class="at">to =</span> <span class="dv">15</span>, <span class="at">by =</span> <span class="dv">1</span>),</span>
<span id="cb102-5"><a href="inferenz-für-quantitative-daten.html#cb102-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">methode_A =</span> <span class="fu">rnorm</span>(<span class="dv">15</span>, <span class="at">mean =</span> <span class="fl">71.5</span>, <span class="at">sd =</span> <span class="fl">9.4</span>),</span>
<span id="cb102-6"><a href="inferenz-für-quantitative-daten.html#cb102-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">methode_B =</span> <span class="fu">rnorm</span>(<span class="dv">15</span>, <span class="at">mean =</span> <span class="fl">84.7</span>, <span class="at">sd =</span> <span class="fl">8.3</span>)</span>
<span id="cb102-7"><a href="inferenz-für-quantitative-daten.html#cb102-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb102-8"><a href="inferenz-für-quantitative-daten.html#cb102-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-9"><a href="inferenz-für-quantitative-daten.html#cb102-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Kennzahlen -------------------------------------------------------------------</span></span>
<span id="cb102-10"><a href="inferenz-für-quantitative-daten.html#cb102-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb102-11"><a href="inferenz-für-quantitative-daten.html#cb102-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-12"><a href="inferenz-für-quantitative-daten.html#cb102-12" aria-hidden="true" tabindex="-1"></a>score <span class="sc">%&gt;%</span> </span>
<span id="cb102-13"><a href="inferenz-für-quantitative-daten.html#cb102-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb102-14"><a href="inferenz-für-quantitative-daten.html#cb102-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean.A =</span> <span class="fu">mean</span>(methode_A),</span>
<span id="cb102-15"><a href="inferenz-für-quantitative-daten.html#cb102-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd.A =</span> <span class="fu">sd</span>(methode_A),</span>
<span id="cb102-16"><a href="inferenz-für-quantitative-daten.html#cb102-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean.B =</span> <span class="fu">mean</span>(methode_B),</span>
<span id="cb102-17"><a href="inferenz-für-quantitative-daten.html#cb102-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd.B =</span> <span class="fu">sd</span>(methode_B)</span>
<span id="cb102-18"><a href="inferenz-für-quantitative-daten.html#cb102-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb102-19"><a href="inferenz-für-quantitative-daten.html#cb102-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb102-20"><a href="inferenz-für-quantitative-daten.html#cb102-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
mean.A
</th>
<th style="text-align:right;">
sd.A
</th>
<th style="text-align:right;">
mean.B
</th>
<th style="text-align:right;">
sd.B
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
72.45
</td>
<td style="text-align:right;">
9.57
</td>
<td style="text-align:right;">
85.23
</td>
<td style="text-align:right;">
7.1
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="inferenz-für-quantitative-daten.html#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verteilung der beiden Variablen prüfen</span></span>
<span id="cb103-2"><a href="inferenz-für-quantitative-daten.html#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb103-3"><a href="inferenz-für-quantitative-daten.html#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(score<span class="sc">$</span>methode_A, <span class="at">main =</span> <span class="st">&quot;QQ-Plot Methode A&quot;</span>)</span>
<span id="cb103-4"><a href="inferenz-für-quantitative-daten.html#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(score<span class="sc">$</span>methode_A)</span>
<span id="cb103-5"><a href="inferenz-für-quantitative-daten.html#cb103-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-6"><a href="inferenz-für-quantitative-daten.html#cb103-6" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(score<span class="sc">$</span>methode_B, <span class="at">main =</span> <span class="st">&quot;QQ-Plot Methode B&quot;</span>)</span>
<span id="cb103-7"><a href="inferenz-für-quantitative-daten.html#cb103-7" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(score<span class="sc">$</span>methode_B)</span></code></pre></div>
<p><img src="statformulasbook_files/figure-html/unnamed-chunk-28-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="inferenz-für-quantitative-daten.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))  </span>
<span id="cb104-2"><a href="inferenz-für-quantitative-daten.html#cb104-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-3"><a href="inferenz-für-quantitative-daten.html#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 95%-CI Grenzen berechnen -----------------------------------------------------</span></span>
<span id="cb104-4"><a href="inferenz-für-quantitative-daten.html#cb104-4" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> .<span class="dv">05</span></span>
<span id="cb104-5"><a href="inferenz-für-quantitative-daten.html#cb104-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-6"><a href="inferenz-für-quantitative-daten.html#cb104-6" aria-hidden="true" tabindex="-1"></a>m.A <span class="ot">&lt;-</span> <span class="fu">mean</span>(score<span class="sc">$</span>methode_A)</span>
<span id="cb104-7"><a href="inferenz-für-quantitative-daten.html#cb104-7" aria-hidden="true" tabindex="-1"></a>s.A <span class="ot">&lt;-</span> <span class="fu">sd</span>(score<span class="sc">$</span>methode_A)</span>
<span id="cb104-8"><a href="inferenz-für-quantitative-daten.html#cb104-8" aria-hidden="true" tabindex="-1"></a>n.A <span class="ot">&lt;-</span> <span class="fu">length</span>(score<span class="sc">$</span>methode_A)</span>
<span id="cb104-9"><a href="inferenz-für-quantitative-daten.html#cb104-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-10"><a href="inferenz-für-quantitative-daten.html#cb104-10" aria-hidden="true" tabindex="-1"></a>m.B <span class="ot">&lt;-</span> <span class="fu">mean</span>(score<span class="sc">$</span>methode_B)</span>
<span id="cb104-11"><a href="inferenz-für-quantitative-daten.html#cb104-11" aria-hidden="true" tabindex="-1"></a>s.B <span class="ot">&lt;-</span> <span class="fu">sd</span>(score<span class="sc">$</span>methode_B)</span>
<span id="cb104-12"><a href="inferenz-für-quantitative-daten.html#cb104-12" aria-hidden="true" tabindex="-1"></a>n.B <span class="ot">&lt;-</span> <span class="fu">length</span>(score<span class="sc">$</span>methode_B)</span>
<span id="cb104-13"><a href="inferenz-für-quantitative-daten.html#cb104-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-14"><a href="inferenz-für-quantitative-daten.html#cb104-14" aria-hidden="true" tabindex="-1"></a>SE <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(s.A<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n.A <span class="sc">+</span> s.B<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n.B)</span>
<span id="cb104-15"><a href="inferenz-für-quantitative-daten.html#cb104-15" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> n.A <span class="sc">+</span> n.B <span class="sc">-</span> <span class="dv">2</span></span>
<span id="cb104-16"><a href="inferenz-für-quantitative-daten.html#cb104-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-17"><a href="inferenz-für-quantitative-daten.html#cb104-17" aria-hidden="true" tabindex="-1"></a>CI <span class="ot">&lt;-</span> (m.B <span class="sc">-</span> m.A) <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">abs</span>(<span class="fu">qt</span>(alpha<span class="sc">/</span><span class="dv">2</span>, df)) <span class="sc">*</span> SE</span>
<span id="cb104-18"><a href="inferenz-für-quantitative-daten.html#cb104-18" aria-hidden="true" tabindex="-1"></a>CI <span class="ot">&lt;-</span> <span class="fu">round</span>(CI, <span class="dv">2</span>)</span>
<span id="cb104-19"><a href="inferenz-für-quantitative-daten.html#cb104-19" aria-hidden="true" tabindex="-1"></a>CI.output <span class="ot">&lt;-</span> <span class="fu">paste</span>((<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> <span class="dv">100</span>, <span class="st">&quot;%-CI [&quot;</span>, CI[<span class="dv">1</span>], <span class="st">&quot;, &quot;</span>, CI[<span class="dv">2</span>], <span class="st">&quot;]&quot;</span>)</span>
<span id="cb104-20"><a href="inferenz-für-quantitative-daten.html#cb104-20" aria-hidden="true" tabindex="-1"></a>CI.output</span></code></pre></div>
<pre><code>## [1] &quot;95 %-CI [ 6.48 ,  19.09 ]&quot;</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="inferenz-für-quantitative-daten.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># p-Wert bestimmen</span></span>
<span id="cb106-2"><a href="inferenz-für-quantitative-daten.html#cb106-2" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> (m.A <span class="sc">-</span> m.B)<span class="sc">/</span>SE</span>
<span id="cb106-3"><a href="inferenz-für-quantitative-daten.html#cb106-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">pt</span>(<span class="sc">-</span><span class="fu">abs</span>(t), <span class="at">df =</span> df)</span>
<span id="cb106-4"><a href="inferenz-für-quantitative-daten.html#cb106-4" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">round</span>(t, <span class="dv">4</span>)</span>
<span id="cb106-5"><a href="inferenz-für-quantitative-daten.html#cb106-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">round</span>(p, <span class="dv">5</span>)</span>
<span id="cb106-6"><a href="inferenz-für-quantitative-daten.html#cb106-6" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;t = &quot;</span>, t, <span class="st">&quot;, p = &quot;</span>, p, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)  </span>
<span id="cb106-7"><a href="inferenz-für-quantitative-daten.html#cb106-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<pre><code>## [1] &quot;t = -4.1552, p = 0.00028&quot;</code></pre>
<p>Ergebnis in allgemein verständlicher Sprache formulieren: Die Studierenden, die mit der Methode B lernen, erzielen im Durchschnitt einen um 12.784, 95 %-CI [ 6.48 , 19.09 ] signifikant höheren Score als die Studierenden, die mit der Methode A lernen, <span class="math inline">\(t\)</span> = -4.1552, <span class="math inline">\(df\)</span> = 28, <span class="math inline">\(p\)</span> = 0.0003.</p>
<p>Einfacher geht es in <code>R</code> mit der Funktion <code>t.test()</code>. <em>Hinweis:</em> Es existieren zwei Varianten des <span class="math inline">\(t\)</span>-Test für unabhängige Stichproben:</p>
<ul>
<li><span class="math inline">\(t\)</span>-Test für zwei Stichproben mit gleichen Varianzen. Die oben gezeigten Formeln sind für diese Testvariante gültig.<br />
</li>
<li><span class="math inline">\(t\)</span>-Test für zwei Stichproben mit ungleichen Varianzen (<span class="math inline">\(Welch\)</span>-Test). Dieser Test führt einen Korrekturfaktor ein der v.a. die Anzahl Freiheitsgrade beeinflusst. Der <span class="math inline">\(Welch\)</span>-Test wird in <code>R</code> standardmässig durchgeführt und ich empfehle, immer diese Testvariante zu verwenden.</li>
</ul>
<p><span class="math inline">\(t\)</span>-Test für unabhängige Stichproben mit ungleichen Varianzen: Welch-Test</p>
<p><span class="math display" id="eq:t-welch">\[\begin{equation}
  t = \frac{\bar{x}_1 - \bar{x}_2}{\sqrt{\frac{\hat{\sigma}_1^2}{n_1} + \frac{\hat{\sigma}_2^2}{n_2}}}
  \tag{6.16}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:df-welch">\[\begin{equation}
  df = \frac{(n_1-1) \cdot (n_2-1)}{(n_2-1) \cdot c^2 + (n_1-1) \cdot (1-c)^2}
  \tag{6.17}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:c-welch">\[\begin{equation}
  c = \frac{\frac{\hat{\sigma}_1^2}{n_1}}{\frac{\hat{\sigma}_1^2}{n_1}+\frac{\hat{\sigma}_2^2}{n_2}}
  \tag{6.18}
\end{equation}\]</span></p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="inferenz-für-quantitative-daten.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># t-Test für gleiche Varianzen</span></span>
<span id="cb108-2"><a href="inferenz-für-quantitative-daten.html#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(score<span class="sc">$</span>methode_B, score<span class="sc">$</span>methode_A, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## 
##  Two Sample t-test
## 
## data:  score$methode_B and score$methode_A
## t = 4.2, df = 28, p-value = 0.0003
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##   6.482 19.086
## sample estimates:
## mean of x mean of y 
##     85.23     72.45</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="inferenz-für-quantitative-daten.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># t-Test für ungleiche Varianzen, R-standard = Welch-Test</span></span>
<span id="cb110-2"><a href="inferenz-für-quantitative-daten.html#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(score<span class="sc">$</span>methode_B, score<span class="sc">$</span>methode_A)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  score$methode_B and score$methode_A
## t = 4.2, df = 26, p-value = 0.0003
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##   6.458 19.110
## sample estimates:
## mean of x mean of y 
##     85.23     72.45</code></pre>
<p><br/></p>
</div>
</div>
<div id="nicht-parametrische-testverfahren" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Nicht-parametrische Testverfahren<a href="inferenz-für-quantitative-daten.html#nicht-parametrische-testverfahren" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Nichtparametrische Tests kommen zur Anwendung, wenn die Annahme der Normalverteilung fraglich ist. Für die Anwendung von nichtparametrischen Tests ist es unerheblich, aus welcher Art von Verteilung die Daten stammen. Deshalb werden diese Prüfverfahren auch als <em>verteilungsfreie</em> Verfahren bezeichnet. Die minimale Voraussetzung ist, dass die Prüfvariable mindestens <em>qualitativ-ordinal</em> skaliert ist.</p>
<p><strong>Übersicht zur Testwahl</strong></p>
<p>Eine Stichprobe <span class="math inline">\(\rightarrow\)</span> <strong>Vorzeichentest</strong></p>
<p>Zwei Stichproben</p>
<ul>
<li>verbundene (abhängige) Stichproben <span class="math inline">\(\rightarrow\)</span> <strong>Wilcoxon-Vorzeichenrangtest</strong>, <strong>Vorzeichentest</strong><br />
</li>
<li>unabhängige Stichproben <span class="math inline">\(\rightarrow\)</span> <strong>Mann-Whitney-U-Test</strong></li>
</ul>
<p><br/></p>
<div id="vorzeichentest" class="section level3 hasAnchor" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Vorzeichentest<a href="inferenz-für-quantitative-daten.html#vorzeichentest" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Referenzen: <span class="citation">King and Eckersley (<a href="#ref-King2019" role="doc-biblioref">2019</a>)</span></p>
<p>Der Einstichproben-Test: Vergleicht einen Median (<span class="math inline">\(\tilde{x}\)</span>) mit einem vorgegebenen Referenzmedian. <span class="math inline">\(H_0: \tilde{x} = Nullwert\)</span>. Prüfgrösse sind die Stichprobendaten.</p>
<p>Vorgehen:</p>
<ol style="list-style-type: decimal">
<li>Vergleiche jeden Wert in der Stichprobe mit dem Nullwert. Für Werte die grösser als
der Nullwert sind, schreibe ein <span class="math inline">\(+\)</span>, für Werte die kleiner als der Nullwert sind, schreibe ein <span class="math inline">\(-\)</span>.<br />
</li>
<li>Zähle die Anzahl <span class="math inline">\(+\)</span> und <span class="math inline">\(-\)</span>.</li>
<li>Berechne anhand der Regeln für die Binomialverteilung die Wahrscheinlichkeit für dieses oder ein extremeres Resultat unter der Annahme, dass die Nullhypothese zutrifft. Dies ist auch unsere Teststatistik!</li>
</ol>
<ul>
<li>Wenn <span class="math inline">\(p\)</span> die Wahrscheinlichkeit für einen Erfolg ist, ist <span class="math inline">\(1-p\)</span> die Wahrscheinlichkeit für einen Misserfolg. <span class="math inline">\(n\)</span> gibt die Anzahl der Versuche an und <span class="math inline">\(k\)</span> die Anzahl der Erfolge.</li>
</ul>
<p><span class="math display" id="eq:binom3">\[\begin{equation}
  p(k, n) =  {n \choose k}p^k(1-p)^{n-k}
  \tag{6.19}
\end{equation}\]</span></p>
<ol start="4" style="list-style-type: decimal">
<li>Vergleiche den p-Wert mit dem Signifikanzniveau. Beachte: Für eine zweiseitige <span class="math inline">\(H_A\)</span> muss der p-Wert verdoppelt werden.</li>
</ol>
<p>Beispiel: In einer neuen Produktionslinie soll die Kontamination eines Produkts mit Schadstoffen
unter einem Grenzwert von 50 Einheiten liegen. Gemessen wurde die Kontamination an einer Stichprobe <span class="math inline">\(n\)</span> = 10.</p>
<p><span class="math inline">\(H_0: \tilde{x} = 50\)</span>, der Median der Stichprobe ist 50<br />
<span class="math inline">\(H_A: \tilde{x} &lt; 50\)</span>, der Median der Stichprobe ist kleiner als 50</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="inferenz-für-quantitative-daten.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Für diesen Code müssen folgende Bibliotheken geladen werden ------------------</span></span>
<span id="cb112-2"><a href="inferenz-für-quantitative-daten.html#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(dplyr)</span></span>
<span id="cb112-3"><a href="inferenz-für-quantitative-daten.html#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="co"># library(knitr)</span></span>
<span id="cb112-4"><a href="inferenz-für-quantitative-daten.html#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="co"># library(kableExtra)</span></span>
<span id="cb112-5"><a href="inferenz-für-quantitative-daten.html#cb112-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-6"><a href="inferenz-für-quantitative-daten.html#cb112-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Kontaminationsdaten ---------------------------------------------------------</span></span>
<span id="cb112-7"><a href="inferenz-für-quantitative-daten.html#cb112-7" aria-hidden="true" tabindex="-1"></a>contamination <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb112-8"><a href="inferenz-für-quantitative-daten.html#cb112-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">c</span>(<span class="fl">45.344</span>, <span class="fl">48.655</span>, <span class="fl">36.199</span>, <span class="fl">54.881</span>, <span class="fl">49.287</span>, </span>
<span id="cb112-9"><a href="inferenz-für-quantitative-daten.html#cb112-9" aria-hidden="true" tabindex="-1"></a>            <span class="fl">49.336</span>, <span class="fl">53.492</span>, <span class="fl">40.702</span>, <span class="fl">46.318</span>, <span class="fl">31.303</span>)</span>
<span id="cb112-10"><a href="inferenz-für-quantitative-daten.html#cb112-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb112-11"><a href="inferenz-für-quantitative-daten.html#cb112-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-12"><a href="inferenz-für-quantitative-daten.html#cb112-12" aria-hidden="true" tabindex="-1"></a>nullvalue <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb112-13"><a href="inferenz-für-quantitative-daten.html#cb112-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-14"><a href="inferenz-für-quantitative-daten.html#cb112-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Differenz zum Nullwert plus oder minus --------------------------------------</span></span>
<span id="cb112-15"><a href="inferenz-für-quantitative-daten.html#cb112-15" aria-hidden="true" tabindex="-1"></a>contamination <span class="ot">&lt;-</span> contamination <span class="sc">%&gt;%</span> </span>
<span id="cb112-16"><a href="inferenz-für-quantitative-daten.html#cb112-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb112-17"><a href="inferenz-für-quantitative-daten.html#cb112-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">diff =</span> value <span class="sc">-</span> nullvalue,</span>
<span id="cb112-18"><a href="inferenz-für-quantitative-daten.html#cb112-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">sign =</span> <span class="fu">if_else</span>(diff <span class="sc">&gt;=</span> <span class="dv">0</span>, <span class="st">&quot;plus&quot;</span>, <span class="st">&quot;minus&quot;</span>)</span>
<span id="cb112-19"><a href="inferenz-für-quantitative-daten.html#cb112-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb112-20"><a href="inferenz-für-quantitative-daten.html#cb112-20" aria-hidden="true" tabindex="-1"></a>contamination <span class="sc">%&gt;%</span> </span>
<span id="cb112-21"><a href="inferenz-für-quantitative-daten.html#cb112-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb112-22"><a href="inferenz-für-quantitative-daten.html#cb112-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
value
</th>
<th style="text-align:right;">
diff
</th>
<th style="text-align:left;">
sign
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
45.34
</td>
<td style="text-align:right;">
-4.656
</td>
<td style="text-align:left;">
minus
</td>
</tr>
<tr>
<td style="text-align:right;">
48.66
</td>
<td style="text-align:right;">
-1.345
</td>
<td style="text-align:left;">
minus
</td>
</tr>
<tr>
<td style="text-align:right;">
36.20
</td>
<td style="text-align:right;">
-13.801
</td>
<td style="text-align:left;">
minus
</td>
</tr>
<tr>
<td style="text-align:right;">
54.88
</td>
<td style="text-align:right;">
4.881
</td>
<td style="text-align:left;">
plus
</td>
</tr>
<tr>
<td style="text-align:right;">
49.29
</td>
<td style="text-align:right;">
-0.713
</td>
<td style="text-align:left;">
minus
</td>
</tr>
<tr>
<td style="text-align:right;">
49.34
</td>
<td style="text-align:right;">
-0.664
</td>
<td style="text-align:left;">
minus
</td>
</tr>
<tr>
<td style="text-align:right;">
53.49
</td>
<td style="text-align:right;">
3.492
</td>
<td style="text-align:left;">
plus
</td>
</tr>
<tr>
<td style="text-align:right;">
40.70
</td>
<td style="text-align:right;">
-9.298
</td>
<td style="text-align:left;">
minus
</td>
</tr>
<tr>
<td style="text-align:right;">
46.32
</td>
<td style="text-align:right;">
-3.682
</td>
<td style="text-align:left;">
minus
</td>
</tr>
<tr>
<td style="text-align:right;">
31.30
</td>
<td style="text-align:right;">
-18.697
</td>
<td style="text-align:left;">
minus
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="inferenz-für-quantitative-daten.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Summe der positiven und negativen Differenzen -------------------------------</span></span>
<span id="cb113-2"><a href="inferenz-für-quantitative-daten.html#cb113-2" aria-hidden="true" tabindex="-1"></a>contamination <span class="sc">%&gt;%</span> </span>
<span id="cb113-3"><a href="inferenz-für-quantitative-daten.html#cb113-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sign) <span class="sc">%&gt;%</span> </span>
<span id="cb113-4"><a href="inferenz-für-quantitative-daten.html#cb113-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb113-5"><a href="inferenz-für-quantitative-daten.html#cb113-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb113-6"><a href="inferenz-für-quantitative-daten.html#cb113-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb113-7"><a href="inferenz-für-quantitative-daten.html#cb113-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb113-8"><a href="inferenz-für-quantitative-daten.html#cb113-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
sign
</th>
<th style="text-align:right;">
n
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
minus
</td>
<td style="text-align:right;">
8
</td>
</tr>
<tr>
<td style="text-align:left;">
plus
</td>
<td style="text-align:right;">
2
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="inferenz-für-quantitative-daten.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Wie gross ist die Wahrscheinlichkeit 8 oder mehr negative aus 10 zu ziehen  </span></span>
<span id="cb114-2"><a href="inferenz-für-quantitative-daten.html#cb114-2" aria-hidden="true" tabindex="-1"></a>p.Wert <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">8</span>, <span class="dv">10</span>, .<span class="dv">5</span>) <span class="sc">+</span> <span class="fu">dbinom</span>(<span class="dv">9</span>, <span class="dv">10</span>, .<span class="dv">5</span>) <span class="sc">+</span> <span class="fu">dbinom</span>(<span class="dv">10</span>, <span class="dv">10</span>, .<span class="dv">5</span>)</span>
<span id="cb114-3"><a href="inferenz-für-quantitative-daten.html#cb114-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-4"><a href="inferenz-für-quantitative-daten.html#cb114-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-5"><a href="inferenz-für-quantitative-daten.html#cb114-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Tabelle für Resultat erstellen ----------------------------------------------</span></span>
<span id="cb114-6"><a href="inferenz-für-quantitative-daten.html#cb114-6" aria-hidden="true" tabindex="-1"></a>cont.result <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb114-7"><a href="inferenz-für-quantitative-daten.html#cb114-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Nr.successes =</span> <span class="dv">8</span>,</span>
<span id="cb114-8"><a href="inferenz-für-quantitative-daten.html#cb114-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Nr.trials =</span> <span class="dv">10</span>, </span>
<span id="cb114-9"><a href="inferenz-für-quantitative-daten.html#cb114-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">p.H0 =</span> .<span class="dv">5</span>,</span>
<span id="cb114-10"><a href="inferenz-für-quantitative-daten.html#cb114-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">p.Value =</span> <span class="fu">round</span>(p.Wert, <span class="dv">4</span>)</span>
<span id="cb114-11"><a href="inferenz-für-quantitative-daten.html#cb114-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb114-12"><a href="inferenz-für-quantitative-daten.html#cb114-12" aria-hidden="true" tabindex="-1"></a>cont.result <span class="sc">%&gt;%</span> </span>
<span id="cb114-13"><a href="inferenz-für-quantitative-daten.html#cb114-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">&quot;Vorzeichentest&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb114-14"><a href="inferenz-für-quantitative-daten.html#cb114-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-30">Table 6.1: </span>Vorzeichentest
</caption>
<thead>
<tr>
<th style="text-align:right;">
Nr.successes
</th>
<th style="text-align:right;">
Nr.trials
</th>
<th style="text-align:right;">
p.H0
</th>
<th style="text-align:right;">
p.Value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0.0547
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="inferenz-für-quantitative-daten.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Einfacher geht es mit R </span></span>
<span id="cb115-2"><a href="inferenz-für-quantitative-daten.html#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="fu">binom.test</span>(<span class="dv">8</span>, <span class="dv">10</span>, .<span class="dv">5</span>, <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Exact binomial test
## 
## data:  8 and 10
## number of successes = 8, number of trials = 10, p-value = 0.05
## alternative hypothesis: true probability of success is greater than 0.5
## 95 percent confidence interval:
##  0.4931 1.0000
## sample estimates:
## probability of success 
##                    0.8</code></pre>
<p>Ergebnis in allgemein verständlicher Sprache formulieren: Der kritische Wert für unsere Teststatistik ist das Signifikanzniveau <span class="math inline">\(\alpha\)</span>. Ist der <span class="math inline">\(p-Wert\)</span> grösser als <span class="math inline">\(\alpha\)</span>, haben wir keine Evidenz dafür, dass wir die Nullhypothese verwerfen können. Es liegt nicht ausreichend Evidenz dafür vor, dass der Median der Kontamination signifikant tiefer ist, als der vorgegebene Grenzwert.</p>
<p>Der Vorzeichentest kann auch als Wilcoxon Vorzeichenrangtest mit dem Parameter <code>mu = nullvalue</code> durchgeführt werden. Das Resultat ist annähernd das selbe.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="inferenz-für-quantitative-daten.html#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(x, <span class="at">mu =</span> Nullwert)</span></code></pre></div>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="inferenz-für-quantitative-daten.html#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wilcoxon-Vorzeichenrangtest</span></span>
<span id="cb118-2"><a href="inferenz-für-quantitative-daten.html#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(<span class="at">x =</span> contamination<span class="sc">$</span>value, <span class="at">mu =</span> nullvalue, <span class="at">alternative =</span> <span class="st">&quot;less&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Wilcoxon signed rank exact test
## 
## data:  contamination$value
## V = 11, p-value = 0.05
## alternative hypothesis: true location is less than 50</code></pre>
<p><br/>
<br/></p>
</div>
<div id="wilcoxon-vorzeichenrangtest" class="section level3 hasAnchor" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> Wilcoxon-Vorzeichenrangtest<a href="inferenz-für-quantitative-daten.html#wilcoxon-vorzeichenrangtest" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Quellen: <span class="citation">Leonhart (<a href="#ref-Leonhart2013" role="doc-biblioref">2013</a>)</span>, <span class="citation">Mi et al. (<a href="#ref-Realstat" role="doc-biblioref">2022</a>)</span></p>
<p>Wilcoxon Vorzeichenrang-Test für gepaarte Daten: <span class="math inline">\(H_0: \tilde{x}_{\Delta} = 0\)</span>, Prüfgrösse
<span class="math inline">\(\tilde{x}_{\Delta}\)</span> = Paarweise Differenzen Stichprobe B minus Stichprobe A.</p>
<p>Voraussetzungen:</p>
<ul>
<li>quantitative oder ordinal skalierte Daten<br />
</li>
<li>unabhängige Beobachtungseinheiten<br />
</li>
<li>Daten sind annähernd symmetrisch um den Median verteilt.</li>
</ul>
<p>Vorgehen:</p>
<ol style="list-style-type: decimal">
<li>Paarweise Differenzen nach Grösse sortieren. Die Vorzeichen werden für die Rangbildung ignoriert, das Vorzeichen wird notiert.<br />
</li>
<li>Rangsummen für positive und negative Differenzen bilden.</li>
</ol>
<p><span class="math display">\[T_+ = \sum Ränge ~mit ~positivem ~Vorzeichen\]</span></p>
<p><span class="math display">\[T_- = \sum Ränge ~mit ~negativem ~Vorzeichen\]</span></p>
<ol start="3" style="list-style-type: decimal">
<li>Die Teststatistik <span class="math inline">\(T\)</span> ist die kleinere der beiden Rangsummen.<br />
</li>
<li>Kritischen Wert <span class="math inline">\(T_{krit}\)</span> in <a href="https://www.real-statistics.com/statistics-tables/wilcoxon-signed-ranks-table/">Vorzeichen-Rang-Tabelle</a> nachschlagen. Wenn <span class="math inline">\(T &lt; T_{krit}\)</span> wird <span class="math inline">\(H_0\)</span> verworfen.</li>
</ol>
<p><strong>Normalapproximation</strong></p>
<ul>
<li>Für grössere Stichproben (Faustregel: <span class="math inline">\(n &gt; 25\)</span>, je nach Autor etwas andere Angaben) ist <span class="math inline">\(T\)</span> annähernd normalverteilt.</li>
</ul>
<p><span class="math display" id="eq:mu-wilcox">\[\begin{equation}
  E(T) = \mu_T = \frac{n \times (n + 1)}{4}
  \tag{6.20}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:var-wilcox">\[\begin{equation}
  \sigma_T^2 = \frac{n \times (n + 1) \times (2n + 1)}{24}
  \tag{6.21}
\end{equation}\]</span></p>
<p><strong>Korrektur für Bindungen</strong></p>
<p>Wenn mehrere Bindungen vorliegen, ist ein besserer Schätzer für die Varianz</p>
<p><span class="math display" id="eq:var-corr">\[\begin{equation}
  \sigma^2 = \frac{n \times (n + 1) \times (2n + 1)}{24} - \frac{1}{48} \sum_t(f_t^3 - f_t)
  \tag{6.22}
\end{equation}\]</span></p>
<p>wobei:</p>
<ul>
<li><span class="math inline">\(t\)</span> = Anzahl Sets von Bindungen<br />
</li>
<li><span class="math inline">\(f_t\)</span> = Häufigkeit von Rang <span class="math inline">\(t\)</span></li>
</ul>
<p><strong>Teststatistik</strong></p>
<p><span class="math display" id="eq:z-wilcox">\[\begin{equation}
  z = \frac{T - \mu_T}{\sigma_T}
  \tag{6.23}
\end{equation}\]</span></p>
<p>Die Approximation einer diskreten Verteilung mittels einer kontinuierlichen Verteilung kann bei <span class="math inline">\(n\)</span> &lt; 60 durch eine Kontinuitätskorrektur bei der Berechnung von <span class="math inline">\(z\)</span> berücksichtigt werden:</p>
<p><span class="math display" id="eq:z-wilcox-contcorr">\[\begin{equation}
  z = \frac{|T - \mu_T|-.5}{\sigma_T}
  \tag{6.24}
\end{equation}\]</span></p>
<p>Beispiel: Zur Überprüfung einer neuen Unterrichtsmethode wurde in einer abhängigen Stichprobe vor und nach einem Sommerlager die Leistung im Fach Statsitik erhoben. Während des Ferienaufenthalts fand ein integrierter Nachhilfekurs in Statistik statt. Die Messung der Statsitikleistung ist im Datensatz <code>prfg</code> gespeichert.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="inferenz-für-quantitative-daten.html#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Für diesen Code müssen folgende Bibliotheken geladen werden ------------------</span></span>
<span id="cb120-2"><a href="inferenz-für-quantitative-daten.html#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(dplyr)</span></span>
<span id="cb120-3"><a href="inferenz-für-quantitative-daten.html#cb120-3" aria-hidden="true" tabindex="-1"></a><span class="co"># library(knitr)</span></span>
<span id="cb120-4"><a href="inferenz-für-quantitative-daten.html#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="co"># library(kableExtra)</span></span>
<span id="cb120-5"><a href="inferenz-für-quantitative-daten.html#cb120-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-6"><a href="inferenz-für-quantitative-daten.html#cb120-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Prüfergebnisse --------------------------------------------------------------</span></span>
<span id="cb120-7"><a href="inferenz-für-quantitative-daten.html#cb120-7" aria-hidden="true" tabindex="-1"></a>prfg <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb120-8"><a href="inferenz-für-quantitative-daten.html#cb120-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">1</span>, <span class="at">to =</span> <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">1</span>),</span>
<span id="cb120-9"><a href="inferenz-für-quantitative-daten.html#cb120-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">vorher =</span> <span class="fu">c</span>(<span class="dv">22</span>, <span class="dv">26</span>, <span class="dv">12</span>, <span class="dv">20</span>, <span class="dv">22</span>, <span class="dv">26</span>, <span class="dv">22</span>, <span class="dv">24</span>, <span class="dv">40</span>, <span class="dv">40</span>),</span>
<span id="cb120-10"><a href="inferenz-für-quantitative-daten.html#cb120-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">nachher =</span> <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">22</span>, <span class="dv">28</span>, <span class="dv">30</span>, <span class="dv">16</span>, <span class="dv">38</span>, <span class="dv">24</span>, <span class="dv">32</span>, <span class="dv">20</span>, <span class="dv">26</span>)</span>
<span id="cb120-11"><a href="inferenz-für-quantitative-daten.html#cb120-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb120-12"><a href="inferenz-für-quantitative-daten.html#cb120-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-13"><a href="inferenz-für-quantitative-daten.html#cb120-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Paarweise Differenzen berechnen ---------------------------------------------</span></span>
<span id="cb120-14"><a href="inferenz-für-quantitative-daten.html#cb120-14" aria-hidden="true" tabindex="-1"></a>prfg <span class="ot">&lt;-</span> prfg <span class="sc">%&gt;%</span> </span>
<span id="cb120-15"><a href="inferenz-für-quantitative-daten.html#cb120-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb120-16"><a href="inferenz-für-quantitative-daten.html#cb120-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">diff =</span> nachher <span class="sc">-</span> vorher</span>
<span id="cb120-17"><a href="inferenz-für-quantitative-daten.html#cb120-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb120-18"><a href="inferenz-für-quantitative-daten.html#cb120-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-19"><a href="inferenz-für-quantitative-daten.html#cb120-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Nach Rängen sortieren -------------------------------------------------------</span></span>
<span id="cb120-20"><a href="inferenz-für-quantitative-daten.html#cb120-20" aria-hidden="true" tabindex="-1"></a>prfg <span class="ot">&lt;-</span> prfg <span class="sc">%&gt;%</span> </span>
<span id="cb120-21"><a href="inferenz-für-quantitative-daten.html#cb120-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb120-22"><a href="inferenz-für-quantitative-daten.html#cb120-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">rang =</span> <span class="fu">rank</span>(<span class="fu">abs</span>(diff))</span>
<span id="cb120-23"><a href="inferenz-für-quantitative-daten.html#cb120-23" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb120-24"><a href="inferenz-für-quantitative-daten.html#cb120-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-25"><a href="inferenz-für-quantitative-daten.html#cb120-25" aria-hidden="true" tabindex="-1"></a><span class="do">## Rangsummen für T berechnen --------------------------------------------------</span></span>
<span id="cb120-26"><a href="inferenz-für-quantitative-daten.html#cb120-26" aria-hidden="true" tabindex="-1"></a>T.plus <span class="ot">&lt;-</span> prfg <span class="sc">%&gt;%</span> </span>
<span id="cb120-27"><a href="inferenz-für-quantitative-daten.html#cb120-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(diff <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb120-28"><a href="inferenz-für-quantitative-daten.html#cb120-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb120-29"><a href="inferenz-für-quantitative-daten.html#cb120-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> <span class="fu">sum</span>(rang)</span>
<span id="cb120-30"><a href="inferenz-für-quantitative-daten.html#cb120-30" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb120-31"><a href="inferenz-für-quantitative-daten.html#cb120-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-32"><a href="inferenz-für-quantitative-daten.html#cb120-32" aria-hidden="true" tabindex="-1"></a>T.minus <span class="ot">&lt;-</span> prfg <span class="sc">%&gt;%</span> </span>
<span id="cb120-33"><a href="inferenz-für-quantitative-daten.html#cb120-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(diff <span class="sc">&lt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb120-34"><a href="inferenz-für-quantitative-daten.html#cb120-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb120-35"><a href="inferenz-für-quantitative-daten.html#cb120-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> <span class="fu">sum</span>(rang)</span>
<span id="cb120-36"><a href="inferenz-für-quantitative-daten.html#cb120-36" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb120-37"><a href="inferenz-für-quantitative-daten.html#cb120-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-38"><a href="inferenz-für-quantitative-daten.html#cb120-38" aria-hidden="true" tabindex="-1"></a><span class="do">## Testgrösse ist das kleinere T -----------------------------------------------</span></span>
<span id="cb120-39"><a href="inferenz-für-quantitative-daten.html#cb120-39" aria-hidden="true" tabindex="-1"></a>T <span class="ot">&lt;-</span> <span class="fu">min</span>(T.plus<span class="sc">$</span>value, T.minus<span class="sc">$</span>value)</span>
<span id="cb120-40"><a href="inferenz-für-quantitative-daten.html#cb120-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-41"><a href="inferenz-für-quantitative-daten.html#cb120-41" aria-hidden="true" tabindex="-1"></a><span class="do">## p-Wert berechnen ------------------------------------------------------------</span></span>
<span id="cb120-42"><a href="inferenz-für-quantitative-daten.html#cb120-42" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">psignrank</span>(T, <span class="at">n =</span> <span class="fu">length</span>(prfg<span class="sc">$</span>diff))</span>
<span id="cb120-43"><a href="inferenz-für-quantitative-daten.html#cb120-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-44"><a href="inferenz-für-quantitative-daten.html#cb120-44" aria-hidden="true" tabindex="-1"></a><span class="do">## Tabelle für Output erstellen ------------------------------------------------</span></span>
<span id="cb120-45"><a href="inferenz-für-quantitative-daten.html#cb120-45" aria-hidden="true" tabindex="-1"></a>prfg.result <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb120-46"><a href="inferenz-für-quantitative-daten.html#cb120-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">T.plus =</span> T.plus<span class="sc">$</span>value,</span>
<span id="cb120-47"><a href="inferenz-für-quantitative-daten.html#cb120-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">T.minus =</span> T.minus<span class="sc">$</span>value,</span>
<span id="cb120-48"><a href="inferenz-für-quantitative-daten.html#cb120-48" aria-hidden="true" tabindex="-1"></a>  <span class="at">T =</span> T,</span>
<span id="cb120-49"><a href="inferenz-für-quantitative-daten.html#cb120-49" aria-hidden="true" tabindex="-1"></a>  <span class="at">T.krit =</span> <span class="dv">8</span>,</span>
<span id="cb120-50"><a href="inferenz-für-quantitative-daten.html#cb120-50" aria-hidden="true" tabindex="-1"></a>  <span class="at">p.Wert =</span> p</span>
<span id="cb120-51"><a href="inferenz-für-quantitative-daten.html#cb120-51" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb120-52"><a href="inferenz-für-quantitative-daten.html#cb120-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-53"><a href="inferenz-für-quantitative-daten.html#cb120-53" aria-hidden="true" tabindex="-1"></a><span class="do">## Tabelle anzeigen ------------------------------------------------------------</span></span>
<span id="cb120-54"><a href="inferenz-für-quantitative-daten.html#cb120-54" aria-hidden="true" tabindex="-1"></a><span class="co"># library(knitr)</span></span>
<span id="cb120-55"><a href="inferenz-für-quantitative-daten.html#cb120-55" aria-hidden="true" tabindex="-1"></a><span class="co"># library(kableExtra)</span></span>
<span id="cb120-56"><a href="inferenz-für-quantitative-daten.html#cb120-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-57"><a href="inferenz-für-quantitative-daten.html#cb120-57" aria-hidden="true" tabindex="-1"></a>prfg.result <span class="sc">%&gt;%</span> </span>
<span id="cb120-58"><a href="inferenz-für-quantitative-daten.html#cb120-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">digits =</span> <span class="dv">3</span>, <span class="at">caption =</span> <span class="st">&quot;Wilcoxon Vorzeichenrangtest&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb120-59"><a href="inferenz-für-quantitative-daten.html#cb120-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-33">Table 6.2: </span>Wilcoxon Vorzeichenrangtest
</caption>
<thead>
<tr>
<th style="text-align:right;">
T.plus
</th>
<th style="text-align:right;">
T.minus
</th>
<th style="text-align:right;">
T
</th>
<th style="text-align:right;">
T.krit
</th>
<th style="text-align:right;">
p.Wert
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0.625
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="inferenz-für-quantitative-daten.html#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Überprüfung mit wilcox.test() -----------------------------------------------</span></span>
<span id="cb121-2"><a href="inferenz-für-quantitative-daten.html#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(prfg<span class="sc">$</span>vorher, prfg<span class="sc">$</span>nachher, <span class="at">paired =</span> <span class="cn">TRUE</span>, <span class="at">correct =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## 
##  Wilcoxon signed rank exact test
## 
## data:  prfg$vorher and prfg$nachher
## V = 22, p-value = 0.6
## alternative hypothesis: true location shift is not equal to 0</code></pre>
<p>Anmerkungen</p>
<ul>
<li>Es wird im Beispiel keine Kontinuitätskorrektur oder eine Korrektur für Bindungen verwendet.<br />
</li>
<li><span class="math inline">\(T.krit\)</span> wurde manuell der Wilcoxon Vorzeichenrang-Tabelle entnommen (<span class="math inline">\(n\)</span> = 10).<br />
</li>
<li>Der p-Wert wurde mit der Funktion <code>psignrank(T, n = n)</code> berechnet.<br />
</li>
<li>Der berechnete <span class="math inline">\(T\)</span>-Wert muss gleich oder kleiner als der kritische <span class="math inline">\(T\)</span>-Wert sein, damit ein signifikanter Unterschied belegt werden kann.<br />
</li>
<li>In <code>R</code> wird <span class="math inline">\(T\)</span> als <span class="math inline">\(V\)</span> angegeben.</li>
</ul>
<p>Interpretation: Der beobachtete <span class="math inline">\(T\)</span>-Wert unterschreitet den kritischen <span class="math inline">\(T\)</span>-Wert nicht, somit ist der Unterschied zwischen den Testzeitpunkten nicht signifikant und der Sommerkurs hat keinen Effekt auf die Leistung der Schüler:innen in Statistik.</p>
</div>
<div id="mann-whitney-u-test" class="section level3 hasAnchor" number="6.2.3">
<h3><span class="header-section-number">6.2.3</span> Mann-Whitney-U-Test<a href="inferenz-für-quantitative-daten.html#mann-whitney-u-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Referenz: <span class="citation">King and Eckersley (<a href="#ref-King2019" role="doc-biblioref">2019</a>)</span>, <span class="citation">Leonhart (<a href="#ref-Leonhart2013" role="doc-biblioref">2013</a>)</span></p>
<p>Wird auch <em>Wilcoxon Rangsummen-Test</em> genannt.</p>
<p>Der U-Test von Mann-Whitney dient dem Vergleich der zentralen Tendenz zweier Stichproben.</p>
<ul>
<li><span class="math inline">\(H_0: P(X &gt; Y) = P(Y &gt; X)\)</span>, m.a.W: Es besteht eine 50%-Wahrscheinlichkeit dafür, dass ein zufällig gezogener Wert aus <span class="math inline">\(X\)</span> grösser ist als ein zufällig gezogener Mittelwert aus <span class="math inline">\(Y\)</span> (und umgekehrt)<br />
</li>
<li><span class="math inline">\(H_0: P(X &gt; Y) \neq P(Y &gt; X)\)</span>, m.a.W: Die Wahrscheinlichkeit ist nicht 50%, dass ein zufällig gezogener Wert aus <span class="math inline">\(X\)</span> grösser ist als ein zufällig gezogener Mittelwert aus <span class="math inline">\(Y\)</span> (und umgekehrt)</li>
</ul>
<p>Voraussetzungen</p>
<ul>
<li>quantiative oder ordinal skalierte Daten<br />
</li>
<li>zwei unabhängige Zufallsstichproben</li>
</ul>
<p>Idee: Die Werte beider Stichproben werden in einer einzige Rangordnung sortiert. Für <span class="math inline">\(H_0\)</span> wird erwartet, dass <span class="math inline">\(x &lt; y\)</span> gleich häufig ist wie <span class="math inline">\(y &lt; x\)</span>.</p>
<p>Teststatistik</p>
<ul>
<li><span class="math inline">\(U_1\)</span> und <span class="math inline">\(U_2\)</span> gibt jeweils an, wie viele Rangwerte der anderen Variablen insgesamt niedriger sind.</li>
<li>Die Teststatistik <span class="math inline">\(U\)</span> ist der kleinere Wert von den beiden <span class="math inline">\(U_1\)</span> und <span class="math inline">\(U_2\)</span>.</li>
<li><span class="math inline">\(U_1\)</span> und <span class="math inline">\(U_2\)</span> werden wie folgt berechnet:</li>
</ul>
<p><span class="math display" id="eq:U1">\[\begin{equation}
  U_1 = n_1 \times n_2+\frac{n_1 \times (n_1+1)}{2} - T_1
  \tag{6.25}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:U2">\[\begin{equation}
  U_2 = n_1 \times n_2+\frac{n_2 \times (n_2+1)}{2} - T_2
  \tag{6.26}
\end{equation}\]</span></p>
<p>wobei, <span class="math inline">\(n_1\)</span> und <span class="math inline">\(n_2\)</span> die jeweiligen Stichprobenumfänge und <span class="math inline">\(T_1\)</span> und <span class="math inline">\(T_2\)</span> die Rangsummen der Gruppen 1 und 2 sind.</p>
<p>Für den Signifikanztest wird nun der kleinere der beiden bestimmten <span class="math inline">\(U\)</span>-Werte verwendet.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="inferenz-für-quantitative-daten.html#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pwilcox</span>(U, <span class="at">m =</span> n1, <span class="at">n =</span> n2, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<p><strong>Normalapproximation</strong></p>
<p>Für grosse Stichprobenumfänge (<span class="math inline">\(n_1\)</span> oder <span class="math inline">\(n_2\)</span> &gt; 10) ist <span class="math inline">\(U\)</span> annähernd normal verteilt mit:</p>
<p><span class="math display" id="eq:mu-U">\[\begin{equation}
  E(U) = \mu_U = \frac{n_1 \times n_2}{2}
  \tag{6.27}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:var-U">\[\begin{equation}
  \sigma_U^2 = \frac{n_1 \times n_2 \times (n_1 + n_2 + 1)}{12}
  \tag{6.28}
\end{equation}\]</span></p>
<p><strong>Teststatistik</strong></p>
<p><span class="math display" id="eq:z-U">\[\begin{equation}
  z = \frac{U - E(U)}{\sigma_U}
  \tag{6.29}
\end{equation}\]</span></p>
<p>Differieren die beiden Stichprobenumfänge <span class="math inline">\(n_1\)</span> und <span class="math inline">\(n_2\)</span> stark, so empfiehlt sich eine Kontinuitätskorrektur des <span class="math inline">\(U\)</span>-Werts.</p>
<p><span class="math display" id="eq:z-U">\[\begin{equation}
  z = \frac{|U - E(U)|-0.5}{\sigma_U}
  \tag{6.29}
\end{equation}\]</span></p>
<p>Wenn eine grosse Zahn von verbundenen Rängen vorliegt (zwei Werte in einer Spalte belegen den selben Rang), wird die Standardabweichung von <span class="math inline">\(U\)</span> wie folgt korrigiert:</p>
<p><span class="math display" id="eq:s-U-corr">\[\begin{equation}
  \sigma_{UCorr} = \sqrt{\frac{n_1 \times n_2}{n(n-1)}} \times \sqrt{\frac{n^3-n}{12}-\sum_{i=1}^k\frac{t_i^3-t_i}{12}}
  \tag{6.30}
\end{equation}\]</span></p>
<p>wobei</p>
<ul>
<li><span class="math inline">\(n = n_1 + n_2\)</span><br />
</li>
<li><span class="math inline">\(t_i\)</span> = Anzahl einzelner Werte, welche den Rang <span class="math inline">\(i\)</span> teilen.<br />
</li>
<li><span class="math inline">\(k\)</span> = Anzahl gebundene Ränge</li>
</ul>
<p>in <code>R</code></p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="inferenz-für-quantitative-daten.html#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(x, y, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="at">paired =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>Beispiel: Erreichen Studierende, die während einer Woche täglich 30 Minuten Statistikübungen machen, bessere Noten in einer Statistikprüfung? Für diese Studie wurden 15 Studierende zufällig ausgewählt und zufällig den Gruppen INT (n = 8) und CON (n = 7) zugeteilt. Beide Gruppen besuchten die Statistikvorlesung. Die Studierenden der Gruppe INT machten zusätzlich während einer Woche täglich 30 Min. Statistikübungen, die Gruppe CON machte keine Statistikübungen. Nach einer Woche wurde ein Statistiktest durchgeführt, der mit 0 bis 100 Punkten bewertet wurde.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="inferenz-für-quantitative-daten.html#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Für diesen Code müssen folgende Bibliotheken geladen werden ------------------</span></span>
<span id="cb125-2"><a href="inferenz-für-quantitative-daten.html#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(dplyr)</span></span>
<span id="cb125-3"><a href="inferenz-für-quantitative-daten.html#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="co"># library(knitr)</span></span>
<span id="cb125-4"><a href="inferenz-für-quantitative-daten.html#cb125-4" aria-hidden="true" tabindex="-1"></a><span class="co"># library(kableExtra)</span></span>
<span id="cb125-5"><a href="inferenz-für-quantitative-daten.html#cb125-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-6"><a href="inferenz-für-quantitative-daten.html#cb125-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Datensatz erstellen ----------------------------------------------------------</span></span>
<span id="cb125-7"><a href="inferenz-für-quantitative-daten.html#cb125-7" aria-hidden="true" tabindex="-1"></a>statex <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb125-8"><a href="inferenz-für-quantitative-daten.html#cb125-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Gruppe =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;INT&quot;</span>, <span class="dv">8</span>), <span class="fu">rep</span>(<span class="st">&quot;CON&quot;</span>, <span class="dv">7</span>)),</span>
<span id="cb125-9"><a href="inferenz-für-quantitative-daten.html#cb125-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Punkte =</span> <span class="fu">c</span>(<span class="dv">89</span>, <span class="dv">92</span>, <span class="dv">94</span>, <span class="dv">96</span>, <span class="dv">91</span>, <span class="dv">99</span>, <span class="dv">84</span>, <span class="dv">90</span>, <span class="dv">88</span>, <span class="dv">93</span>, <span class="dv">95</span>, <span class="dv">75</span>, <span class="dv">72</span>, <span class="dv">80</span>, <span class="dv">81</span>)</span>
<span id="cb125-10"><a href="inferenz-für-quantitative-daten.html#cb125-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb125-11"><a href="inferenz-für-quantitative-daten.html#cb125-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-12"><a href="inferenz-für-quantitative-daten.html#cb125-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Prüfungsergebnisse nach Rängen sortieren  </span></span>
<span id="cb125-13"><a href="inferenz-für-quantitative-daten.html#cb125-13" aria-hidden="true" tabindex="-1"></a>statex <span class="ot">&lt;-</span> statex <span class="sc">%&gt;%</span> </span>
<span id="cb125-14"><a href="inferenz-für-quantitative-daten.html#cb125-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb125-15"><a href="inferenz-für-quantitative-daten.html#cb125-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">Rang =</span> <span class="dv">16</span> <span class="sc">-</span> <span class="fu">rank</span>(Punkte, <span class="at">ties.method =</span> <span class="st">&quot;average&quot;</span> )</span>
<span id="cb125-16"><a href="inferenz-für-quantitative-daten.html#cb125-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb125-17"><a href="inferenz-für-quantitative-daten.html#cb125-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-18"><a href="inferenz-für-quantitative-daten.html#cb125-18" aria-hidden="true" tabindex="-1"></a>statex <span class="sc">%&gt;%</span> </span>
<span id="cb125-19"><a href="inferenz-für-quantitative-daten.html#cb125-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Rang) <span class="sc">%&gt;%</span> </span>
<span id="cb125-20"><a href="inferenz-für-quantitative-daten.html#cb125-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">digits =</span> <span class="dv">2</span>, <span class="at">caption =</span> <span class="st">&quot;Statistikresultate mit Rängen&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb125-21"><a href="inferenz-für-quantitative-daten.html#cb125-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:data-statex">Table 6.3: </span>Statistikresultate mit Rängen
</caption>
<thead>
<tr>
<th style="text-align:left;">
Gruppe
</th>
<th style="text-align:right;">
Punkte
</th>
<th style="text-align:right;">
Rang
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
INT
</td>
<td style="text-align:right;">
99
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
INT
</td>
<td style="text-align:right;">
96
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
CON
</td>
<td style="text-align:right;">
95
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
INT
</td>
<td style="text-align:right;">
94
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
CON
</td>
<td style="text-align:right;">
93
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
INT
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:left;">
INT
</td>
<td style="text-align:right;">
91
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:left;">
INT
</td>
<td style="text-align:right;">
90
</td>
<td style="text-align:right;">
8
</td>
</tr>
<tr>
<td style="text-align:left;">
INT
</td>
<td style="text-align:right;">
89
</td>
<td style="text-align:right;">
9
</td>
</tr>
<tr>
<td style="text-align:left;">
CON
</td>
<td style="text-align:right;">
88
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
INT
</td>
<td style="text-align:right;">
84
</td>
<td style="text-align:right;">
11
</td>
</tr>
<tr>
<td style="text-align:left;">
CON
</td>
<td style="text-align:right;">
81
</td>
<td style="text-align:right;">
12
</td>
</tr>
<tr>
<td style="text-align:left;">
CON
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:right;">
13
</td>
</tr>
<tr>
<td style="text-align:left;">
CON
</td>
<td style="text-align:right;">
75
</td>
<td style="text-align:right;">
14
</td>
</tr>
<tr>
<td style="text-align:left;">
CON
</td>
<td style="text-align:right;">
72
</td>
<td style="text-align:right;">
15
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="inferenz-für-quantitative-daten.html#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rangsummen berechnen</span></span>
<span id="cb126-2"><a href="inferenz-für-quantitative-daten.html#cb126-2" aria-hidden="true" tabindex="-1"></a>rangsummen <span class="ot">&lt;-</span> statex <span class="sc">%&gt;%</span> </span>
<span id="cb126-3"><a href="inferenz-für-quantitative-daten.html#cb126-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Gruppe) <span class="sc">%&gt;%</span> </span>
<span id="cb126-4"><a href="inferenz-für-quantitative-daten.html#cb126-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb126-5"><a href="inferenz-für-quantitative-daten.html#cb126-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Rangsumme =</span> <span class="fu">sum</span>(Rang)</span>
<span id="cb126-6"><a href="inferenz-für-quantitative-daten.html#cb126-6" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb126-7"><a href="inferenz-für-quantitative-daten.html#cb126-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-8"><a href="inferenz-für-quantitative-daten.html#cb126-8" aria-hidden="true" tabindex="-1"></a>T1 <span class="ot">&lt;-</span> rangsummen<span class="sc">$</span>Rangsumme[<span class="dv">1</span>]      <span class="co"># Rangsumme für Gruppe CON</span></span>
<span id="cb126-9"><a href="inferenz-für-quantitative-daten.html#cb126-9" aria-hidden="true" tabindex="-1"></a>T2 <span class="ot">&lt;-</span> rangsummen<span class="sc">$</span>Rangsumme[<span class="dv">2</span>]      <span class="co"># Rangsumme für Gruppe INT</span></span>
<span id="cb126-10"><a href="inferenz-für-quantitative-daten.html#cb126-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-11"><a href="inferenz-für-quantitative-daten.html#cb126-11" aria-hidden="true" tabindex="-1"></a><span class="co"># U berechnen</span></span>
<span id="cb126-12"><a href="inferenz-für-quantitative-daten.html#cb126-12" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">7</span></span>
<span id="cb126-13"><a href="inferenz-für-quantitative-daten.html#cb126-13" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb126-14"><a href="inferenz-für-quantitative-daten.html#cb126-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-15"><a href="inferenz-für-quantitative-daten.html#cb126-15" aria-hidden="true" tabindex="-1"></a>U1 <span class="ot">&lt;-</span> n1 <span class="sc">*</span> n2 <span class="sc">+</span> (n1 <span class="sc">*</span> (n1 <span class="sc">+</span> <span class="dv">1</span>))<span class="sc">/</span><span class="dv">2</span> <span class="sc">-</span> T1</span>
<span id="cb126-16"><a href="inferenz-für-quantitative-daten.html#cb126-16" aria-hidden="true" tabindex="-1"></a>U2 <span class="ot">&lt;-</span> n1 <span class="sc">*</span> n2 <span class="sc">+</span> (n2 <span class="sc">*</span> (n2 <span class="sc">+</span> <span class="dv">1</span>))<span class="sc">/</span><span class="dv">2</span> <span class="sc">-</span> T2</span>
<span id="cb126-17"><a href="inferenz-für-quantitative-daten.html#cb126-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-18"><a href="inferenz-für-quantitative-daten.html#cb126-18" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">min</span>(U1, U2)</span>
<span id="cb126-19"><a href="inferenz-für-quantitative-daten.html#cb126-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-20"><a href="inferenz-für-quantitative-daten.html#cb126-20" aria-hidden="true" tabindex="-1"></a><span class="co"># p-Wert berechnen</span></span>
<span id="cb126-21"><a href="inferenz-für-quantitative-daten.html#cb126-21" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pwilcox</span>(U, <span class="at">m =</span> n1, <span class="at">n =</span> n2, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>))</span>
<span id="cb126-22"><a href="inferenz-für-quantitative-daten.html#cb126-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-23"><a href="inferenz-für-quantitative-daten.html#cb126-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Resultat als Tabelle ausgeben</span></span>
<span id="cb126-24"><a href="inferenz-für-quantitative-daten.html#cb126-24" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb126-25"><a href="inferenz-für-quantitative-daten.html#cb126-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">T1 =</span> T1,</span>
<span id="cb126-26"><a href="inferenz-für-quantitative-daten.html#cb126-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">T2 =</span> T2,</span>
<span id="cb126-27"><a href="inferenz-für-quantitative-daten.html#cb126-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">n1 =</span> n1,</span>
<span id="cb126-28"><a href="inferenz-für-quantitative-daten.html#cb126-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">n2 =</span> n2,</span>
<span id="cb126-29"><a href="inferenz-für-quantitative-daten.html#cb126-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">U1 =</span> U1,</span>
<span id="cb126-30"><a href="inferenz-für-quantitative-daten.html#cb126-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">U2 =</span> U2,</span>
<span id="cb126-31"><a href="inferenz-für-quantitative-daten.html#cb126-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">U =</span> U,</span>
<span id="cb126-32"><a href="inferenz-für-quantitative-daten.html#cb126-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">p =</span> <span class="fu">round</span>(p, <span class="dv">4</span>)</span>
<span id="cb126-33"><a href="inferenz-für-quantitative-daten.html#cb126-33" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb126-34"><a href="inferenz-für-quantitative-daten.html#cb126-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-35"><a href="inferenz-für-quantitative-daten.html#cb126-35" aria-hidden="true" tabindex="-1"></a>result <span class="sc">%&gt;%</span> </span>
<span id="cb126-36"><a href="inferenz-für-quantitative-daten.html#cb126-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">digits =</span> <span class="dv">4</span>, <span class="at">caption =</span> <span class="st">&quot;Mann-Whitney-U-Test&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb126-37"><a href="inferenz-für-quantitative-daten.html#cb126-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:data-statex">Table 6.3: </span>Mann-Whitney-U-Test
</caption>
<thead>
<tr>
<th style="text-align:right;">
T1
</th>
<th style="text-align:right;">
T2
</th>
<th style="text-align:right;">
n1
</th>
<th style="text-align:right;">
n2
</th>
<th style="text-align:right;">
U1
</th>
<th style="text-align:right;">
U2
</th>
<th style="text-align:right;">
U
</th>
<th style="text-align:right;">
p
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
72
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
0.0721
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="inferenz-für-quantitative-daten.html#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vergleich mit wilcox.test()</span></span>
<span id="cb127-2"><a href="inferenz-für-quantitative-daten.html#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(</span>
<span id="cb127-3"><a href="inferenz-für-quantitative-daten.html#cb127-3" aria-hidden="true" tabindex="-1"></a>  Punkte <span class="sc">~</span> Gruppe, <span class="at">data =</span> statex, </span>
<span id="cb127-4"><a href="inferenz-für-quantitative-daten.html#cb127-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">paired =</span> <span class="cn">FALSE</span>, </span>
<span id="cb127-5"><a href="inferenz-für-quantitative-daten.html#cb127-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Wilcoxon rank sum exact test
## 
## data:  Punkte by Gruppe
## W = 12, p-value = 0.07
## alternative hypothesis: true location shift is not equal to 0</code></pre>
<p>Interpretation: Studierende, die während einer Woche täglich 30 Minunten Statistikübungen machen, erreichten in unserer Studie im Durchschnitt eine um 8.45 Punkte höhere Punktzahl in der Statistikprüfung, Mann-Whitney-U = 12, p = 0.0721. Damit liegt keine Evidenz dafür vor, dass sich die Prüfungsergebnisse im Durchschnitt zwischen den beiden Gruppen unterscheiden.</p>
</div>
</div>
<div id="bootstrap-methode" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Bootstrap-Methode<a href="inferenz-für-quantitative-daten.html#bootstrap-methode" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Hauptquelle: <span class="citation">Moore, McCabe, and Craig (<a href="#ref-IPS10" role="doc-biblioref">2021</a>)</span>, Kap. 16</p>
<p>Bootstrap-Methoden sind eine Alternative zu nichtparametrischen Tests, wenn die Voraussetzungen für parametrische Tests nicht erfüllt sind. Die Berechnung von Bootstrap-Intervallen und Permutationstests setzt erhebliche Rechenleistung voraus, weshalb diese Methoden erst in jüngerer Zeit Verbreitung finden.</p>
<div id="vorgehen-2" class="section level3 hasAnchor" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Vorgehen<a href="inferenz-für-quantitative-daten.html#vorgehen-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Bootstrapping ist eine Möglichkeit, die Stichprobenverteilung aus einer einzigen Stichprobe annähernd zu ermitteln.</p>
<ol style="list-style-type: decimal">
<li>Zufallsstichprobe im Umfang <span class="math inline">\(n\)</span> aus der zu untersuchenden Population ziehen.<br />
</li>
<li>Resampling: <span class="math inline">\(B\)</span> Stichproben im Umfang <span class="math inline">\(n\)</span> aus der Zufallsstichprobe ziehen. Dabei wird nach jedem Zug wieder “zurückgelegt”, d.h. jede Beobachtungseinheit in der Stichprobe kann mehr als einmal gezogen werden. <span class="math inline">\(B\)</span> hat in der Regel einen Wert von &gt; 10’000.<br />
</li>
<li>Bootstrapvertreilung: Die Bootstrapverteilung einer Kennzahl, z.B. <span class="math inline">\(\bar{x}\)</span>, repräsentiert die Werte, welche die Kennzahl in allen <span class="math inline">\(B\)</span> Resamples angenommen hat, also die Stichprobenverteilung der Kennzahl.</li>
</ol>
<p><span class="math display" id="eq:x-boot">\[\begin{equation}
  \bar{x}_{boot} = \frac{1}{B}\sum{\bar{x}^*}
  \tag{6.31}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:se-boot">\[\begin{equation}
  SE_{boot} = \sqrt{\frac{1}{B-1}\sum(\bar{x}^* - \bar{x}_{boot})^2}
  \tag{6.32}
\end{equation}\]</span></p>
<ul>
<li><span class="math inline">\(B\)</span>: Anzahl Resampling-Stichproben<br />
</li>
<li><span class="math inline">\(\bar{x}^*\)</span>: Mittelwerte von jeder Resampling-Stichprobe<br />
</li>
<li><span class="math inline">\(\bar{x}_{boot}\)</span>: Mittelwert der Resampling-Mittelwerte</li>
<li><span class="math inline">\(SE_{boot}\)</span>: Standardfehler für <span class="math inline">\(\bar{x}_{boot}\)</span>; ist identisch mit der Standardabweichung der Verteilung von <span class="math inline">\(\bar{x}^*\)</span></li>
</ul>
<p>Konfidenzintervall für den Mittelwert berechnen</p>
<p><span class="math display" id="eq:estbias">\[\begin{equation}
  Est.Bias = \bar{x}_{Stichprobe} - \bar{x}_{boot}
  \tag{6.33}
\end{equation}\]</span></p>
<ul>
<li>Bootstrap-z-CI: Wenn die Bootstrap-Verteilung annähernd normalverteilt und der Bias-Schätzer <span class="math inline">\(Est.Bias\)</span> klein sind:</li>
</ul>
<p><span class="math display" id="eq:ci-boot">\[\begin{equation}
  CI_{boot} = \bar{x}_{boot} \pm z_{1-\frac{\alpha}{2}} \times SE_{boot}
  \tag{6.34}
\end{equation}\]</span></p>
<ul>
<li>Bootstrap-Perzentilen-CI: Wenn die Bootstrap-Verteilung schief und der Bias-Schätzer klein sind</li>
</ul>
<p><span class="math display" id="eq:ci-boot2">\[\begin{equation}
  CI_{boot} = [P_{.025, \bar{x}^*}, P_{.975, \bar{x}^*}]
  \tag{6.35}
\end{equation}\]</span></p>
<ul>
<li>Bootstrap bias-corrected accelerated interval (BCa)</li>
</ul>
<p>Das BCa ist eine Modifikation des Perzentilen-CI und sollte immer angewandt werden, wenn die Software dies erlaubt (siehe package <code>boot</code> unten)</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="inferenz-für-quantitative-daten.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Source: StatQuest https://youtu.be/N4ZQQqyIf6k</span></span>
<span id="cb129-2"><a href="inferenz-für-quantitative-daten.html#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb129-3"><a href="inferenz-für-quantitative-daten.html#cb129-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-4"><a href="inferenz-für-quantitative-daten.html#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="co"># simulated data ---------------------------------------------------------------</span></span>
<span id="cb129-5"><a href="inferenz-für-quantitative-daten.html#cb129-5" aria-hidden="true" tabindex="-1"></a>drug <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">3.6</span>, <span class="sc">-</span><span class="fl">2.8</span>, <span class="sc">-</span><span class="fl">1.5</span>, <span class="fl">1.4</span>, <span class="fl">1.8</span>, <span class="fl">2.2</span>, <span class="fl">2.8</span>, <span class="fl">3.6</span>)</span>
<span id="cb129-6"><a href="inferenz-für-quantitative-daten.html#cb129-6" aria-hidden="true" tabindex="-1"></a>psych<span class="sc">::</span><span class="fu">describe</span>(drug)</span></code></pre></div>
<pre><code>##    vars n mean   sd median trimmed  mad  min max range  skew kurtosis   se
## X1    1 8 0.49 2.73    1.6    0.49 2.37 -3.6 3.6   7.2 -0.38    -1.76 0.96</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="inferenz-für-quantitative-daten.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1000 means and medians from 10000samples with replacement --------------------</span></span>
<span id="cb131-2"><a href="inferenz-für-quantitative-daten.html#cb131-2" aria-hidden="true" tabindex="-1"></a>mean.samples <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb131-3"><a href="inferenz-für-quantitative-daten.html#cb131-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>){</span>
<span id="cb131-4"><a href="inferenz-für-quantitative-daten.html#cb131-4" aria-hidden="true" tabindex="-1"></a>  sample <span class="ot">&lt;-</span> <span class="fu">sample</span>(drug, <span class="at">size =</span> <span class="fu">length</span>(drug), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb131-5"><a href="inferenz-für-quantitative-daten.html#cb131-5" aria-hidden="true" tabindex="-1"></a>  mean.samples[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(sample)</span>
<span id="cb131-6"><a href="inferenz-für-quantitative-daten.html#cb131-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb131-7"><a href="inferenz-für-quantitative-daten.html#cb131-7" aria-hidden="true" tabindex="-1"></a>bootstrap <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb131-8"><a href="inferenz-für-quantitative-daten.html#cb131-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">m.samples =</span> mean.samples</span>
<span id="cb131-9"><a href="inferenz-für-quantitative-daten.html#cb131-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb131-10"><a href="inferenz-für-quantitative-daten.html#cb131-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-11"><a href="inferenz-für-quantitative-daten.html#cb131-11" aria-hidden="true" tabindex="-1"></a><span class="co"># plot histogram and mean ------------------------------------------------------</span></span>
<span id="cb131-12"><a href="inferenz-für-quantitative-daten.html#cb131-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(bootstrap, <span class="fu">aes</span>(<span class="at">x =</span> m.samples)) <span class="sc">+</span></span>
<span id="cb131-13"><a href="inferenz-für-quantitative-daten.html#cb131-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb131-14"><a href="inferenz-für-quantitative-daten.html#cb131-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">paste</span>(<span class="st">&quot;bootstrapped means, samples = 10000, mean = &quot;</span>, </span>
<span id="cb131-15"><a href="inferenz-für-quantitative-daten.html#cb131-15" aria-hidden="true" tabindex="-1"></a>                <span class="fu">round</span>(<span class="fu">mean</span>(bootstrap<span class="sc">$</span>m.samples), <span class="dv">4</span>)), </span>
<span id="cb131-16"><a href="inferenz-für-quantitative-daten.html#cb131-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;Sample mean = &quot;</span>, <span class="fu">round</span>(<span class="fu">mean</span>(drug), <span class="dv">4</span>),</span>
<span id="cb131-17"><a href="inferenz-für-quantitative-daten.html#cb131-17" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;, Est. bootstrap bias = &quot;</span>, </span>
<span id="cb131-18"><a href="inferenz-für-quantitative-daten.html#cb131-18" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">round</span>(<span class="fu">mean</span>(drug)<span class="sc">-</span><span class="fu">mean</span>(bootstrap<span class="sc">$</span>m.samples), <span class="dv">3</span>)))</span></code></pre></div>
<p><img src="statformulasbook_files/figure-html/unnamed-chunk-37-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="inferenz-für-quantitative-daten.html#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate CI -----------------------------------------------------------------</span></span>
<span id="cb132-2"><a href="inferenz-für-quantitative-daten.html#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Bootstrap-z-Intervall</span></span>
<span id="cb132-3"><a href="inferenz-für-quantitative-daten.html#cb132-3" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb132-4"><a href="inferenz-für-quantitative-daten.html#cb132-4" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">mean</span>(bootstrap<span class="sc">$</span>m.samples)</span>
<span id="cb132-5"><a href="inferenz-für-quantitative-daten.html#cb132-5" aria-hidden="true" tabindex="-1"></a>SE <span class="ot">&lt;-</span> <span class="fu">sd</span>(bootstrap<span class="sc">$</span>m.samples)</span>
<span id="cb132-6"><a href="inferenz-für-quantitative-daten.html#cb132-6" aria-hidden="true" tabindex="-1"></a>CI.z <span class="ot">&lt;-</span> M <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">abs</span>(<span class="fu">qnorm</span>(alpha<span class="sc">/</span><span class="dv">2</span>)) <span class="sc">*</span> SE</span>
<span id="cb132-7"><a href="inferenz-für-quantitative-daten.html#cb132-7" aria-hidden="true" tabindex="-1"></a>CI.z</span></code></pre></div>
<pre><code>## [1] -1.300  2.259</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="inferenz-für-quantitative-daten.html#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bootstrap-Perzentilen-Intervall</span></span>
<span id="cb134-2"><a href="inferenz-für-quantitative-daten.html#cb134-2" aria-hidden="true" tabindex="-1"></a>CI.perc.lo <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(.<span class="dv">025</span>, </span>
<span id="cb134-3"><a href="inferenz-für-quantitative-daten.html#cb134-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mean =</span> <span class="fu">mean</span>(bootstrap<span class="sc">$</span>m.samples),</span>
<span id="cb134-4"><a href="inferenz-für-quantitative-daten.html#cb134-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">sd =</span> <span class="fu">sd</span>(bootstrap<span class="sc">$</span>m.samples))</span>
<span id="cb134-5"><a href="inferenz-für-quantitative-daten.html#cb134-5" aria-hidden="true" tabindex="-1"></a>CI.perc.hi <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(.<span class="dv">975</span>, </span>
<span id="cb134-6"><a href="inferenz-für-quantitative-daten.html#cb134-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mean =</span> <span class="fu">mean</span>(bootstrap<span class="sc">$</span>m.samples),</span>
<span id="cb134-7"><a href="inferenz-für-quantitative-daten.html#cb134-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">sd =</span> <span class="fu">sd</span>(bootstrap<span class="sc">$</span>m.samples))</span>
<span id="cb134-8"><a href="inferenz-für-quantitative-daten.html#cb134-8" aria-hidden="true" tabindex="-1"></a>CI.perc <span class="ot">&lt;-</span> <span class="fu">c</span>(CI.perc.lo, CI.perc.hi)</span>
<span id="cb134-9"><a href="inferenz-für-quantitative-daten.html#cb134-9" aria-hidden="true" tabindex="-1"></a>CI.perc</span></code></pre></div>
<pre><code>## [1] -1.300  2.259</code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="inferenz-für-quantitative-daten.html#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Hypothesis-Test --------------------------------------------------------------</span></span>
<span id="cb136-2"><a href="inferenz-für-quantitative-daten.html#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="co"># if H0 was true, we would expect the mean value to be 0</span></span>
<span id="cb136-3"><a href="inferenz-für-quantitative-daten.html#cb136-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-4"><a href="inferenz-für-quantitative-daten.html#cb136-4" aria-hidden="true" tabindex="-1"></a><span class="co"># shift data to represent the nullhypothesis -----------------------------------</span></span>
<span id="cb136-5"><a href="inferenz-für-quantitative-daten.html#cb136-5" aria-hidden="true" tabindex="-1"></a>drug.h0 <span class="ot">&lt;-</span> drug <span class="sc">-</span> <span class="fu">mean</span>(drug)</span>
<span id="cb136-6"><a href="inferenz-für-quantitative-daten.html#cb136-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-7"><a href="inferenz-für-quantitative-daten.html#cb136-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 1000 means from 1000 samples with replacement from normalised data -----------</span></span>
<span id="cb136-8"><a href="inferenz-für-quantitative-daten.html#cb136-8" aria-hidden="true" tabindex="-1"></a><span class="co"># show how the mean varies when H0 were true</span></span>
<span id="cb136-9"><a href="inferenz-für-quantitative-daten.html#cb136-9" aria-hidden="true" tabindex="-1"></a>mean.samples <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb136-10"><a href="inferenz-für-quantitative-daten.html#cb136-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>){</span>
<span id="cb136-11"><a href="inferenz-für-quantitative-daten.html#cb136-11" aria-hidden="true" tabindex="-1"></a>  sample <span class="ot">&lt;-</span> <span class="fu">sample</span>(drug.h0, <span class="at">size =</span> <span class="fu">length</span>(drug.h0), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb136-12"><a href="inferenz-für-quantitative-daten.html#cb136-12" aria-hidden="true" tabindex="-1"></a>  mean.samples[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(sample)</span>
<span id="cb136-13"><a href="inferenz-für-quantitative-daten.html#cb136-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb136-14"><a href="inferenz-für-quantitative-daten.html#cb136-14" aria-hidden="true" tabindex="-1"></a>bootstrap<span class="sc">$</span>m.samples.norm <span class="ot">&lt;-</span> mean.samples</span>
<span id="cb136-15"><a href="inferenz-für-quantitative-daten.html#cb136-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-16"><a href="inferenz-für-quantitative-daten.html#cb136-16" aria-hidden="true" tabindex="-1"></a><span class="co"># plot histogram and mean ------------------------------------------------------</span></span>
<span id="cb136-17"><a href="inferenz-für-quantitative-daten.html#cb136-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(bootstrap, <span class="fu">aes</span>(<span class="at">x =</span> m.samples.norm)) <span class="sc">+</span></span>
<span id="cb136-18"><a href="inferenz-für-quantitative-daten.html#cb136-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">binwidth =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb136-19"><a href="inferenz-für-quantitative-daten.html#cb136-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="sc">-</span>.<span class="dv">49</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb136-20"><a href="inferenz-für-quantitative-daten.html#cb136-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> .<span class="dv">49</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb136-21"><a href="inferenz-für-quantitative-daten.html#cb136-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">paste</span>(<span class="st">&quot;bootstrapped means, samples = 10000, M = &quot;</span>, </span>
<span id="cb136-22"><a href="inferenz-für-quantitative-daten.html#cb136-22" aria-hidden="true" tabindex="-1"></a>                <span class="fu">round</span>(<span class="fu">mean</span>(bootstrap<span class="sc">$</span>m.samples.norm), <span class="dv">4</span>)), </span>
<span id="cb136-23"><a href="inferenz-für-quantitative-daten.html#cb136-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;boundaries two.sided = &quot;</span>, <span class="fu">round</span>(<span class="fu">mean</span>(drug), <span class="dv">4</span>)))</span></code></pre></div>
<p><img src="statformulasbook_files/figure-html/unnamed-chunk-37-2.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="inferenz-für-quantitative-daten.html#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate p-value ------------------------------------------------------------</span></span>
<span id="cb137-2"><a href="inferenz-für-quantitative-daten.html#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="co"># What is the probability for observing a mean Value of less than -.49 and more</span></span>
<span id="cb137-3"><a href="inferenz-für-quantitative-daten.html#cb137-3" aria-hidden="true" tabindex="-1"></a><span class="co"># than .49 under H0 </span></span>
<span id="cb137-4"><a href="inferenz-für-quantitative-daten.html#cb137-4" aria-hidden="true" tabindex="-1"></a>M.drug <span class="ot">&lt;-</span> <span class="fu">mean</span>(drug)</span>
<span id="cb137-5"><a href="inferenz-für-quantitative-daten.html#cb137-5" aria-hidden="true" tabindex="-1"></a><span class="co"># pnorm(M.drug) - pnorm(-M.drug) # prob for finding a mean value between -.49 and .49</span></span>
<span id="cb137-6"><a href="inferenz-für-quantitative-daten.html#cb137-6" aria-hidden="true" tabindex="-1"></a><span class="co"># pnorm(-M.drug) # prob for finding a mean value &lt; -.49</span></span>
<span id="cb137-7"><a href="inferenz-für-quantitative-daten.html#cb137-7" aria-hidden="true" tabindex="-1"></a><span class="co"># pnorm(M.drug, lower.tail = FALSE) # prob for finding a mean Value &gt; .49</span></span>
<span id="cb137-8"><a href="inferenz-für-quantitative-daten.html#cb137-8" aria-hidden="true" tabindex="-1"></a><span class="co"># prob finding a p-value of .49 or more extreme two.sided</span></span>
<span id="cb137-9"><a href="inferenz-für-quantitative-daten.html#cb137-9" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(<span class="sc">-</span>M.drug) <span class="sc">+</span> <span class="fu">pnorm</span>(M.drug, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb137-10"><a href="inferenz-für-quantitative-daten.html#cb137-10" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">&quot;p =&quot;</span>, <span class="fu">round</span>(p, <span class="dv">3</span>))</span></code></pre></div>
<pre><code>## [1] &quot;p = 0.626&quot;</code></pre>
</div>
<div id="bootstrapping-in-r" class="section level3 hasAnchor" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> Bootstrapping in <code>R</code><a href="inferenz-für-quantitative-daten.html#bootstrapping-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Für Bootstrap-Methoden steht das package <code>boot</code> zur Verfügung.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="inferenz-für-quantitative-daten.html#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># source: https://www.statmethods.net/advstats/bootstrapping.html</span></span>
<span id="cb139-2"><a href="inferenz-für-quantitative-daten.html#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;boot&quot;)</span></span>
<span id="cb139-3"><a href="inferenz-für-quantitative-daten.html#cb139-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb139-4"><a href="inferenz-für-quantitative-daten.html#cb139-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-5"><a href="inferenz-für-quantitative-daten.html#cb139-5" aria-hidden="true" tabindex="-1"></a>samplemean <span class="ot">&lt;-</span> <span class="cf">function</span>(x, d) {</span>
<span id="cb139-6"><a href="inferenz-für-quantitative-daten.html#cb139-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(x[d]))</span>
<span id="cb139-7"><a href="inferenz-für-quantitative-daten.html#cb139-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb139-8"><a href="inferenz-für-quantitative-daten.html#cb139-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-9"><a href="inferenz-für-quantitative-daten.html#cb139-9" aria-hidden="true" tabindex="-1"></a>boot.drug <span class="ot">&lt;-</span> <span class="fu">boot</span>(drug, <span class="at">statistic =</span> samplemean, <span class="at">R =</span> <span class="dv">10000</span>)</span>
<span id="cb139-10"><a href="inferenz-für-quantitative-daten.html#cb139-10" aria-hidden="true" tabindex="-1"></a>boot.drug</span></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = drug, statistic = samplemean, R = 10000)
## 
## 
## Bootstrap Statistics :
##     original    bias    std. error
## t1*   0.4875 0.0009487      0.8974</code></pre>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="inferenz-für-quantitative-daten.html#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(boot.drug, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="statformulasbook_files/figure-html/unnamed-chunk-38-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="inferenz-für-quantitative-daten.html#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boot.ci</span>(boot.drug)</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 10000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot.drug)
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   (-1.272,  2.245 )   (-1.162,  2.288 )  
## 
## Level     Percentile            BCa          
## 95%   (-1.312,  2.137 )   (-1.475,  2.013 )  
## Calculations and Intervals on Original Scale</code></pre>

</div>
</div>
</div>
<h3> Referenzen<a href="referenzen.html#referenzen" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-King2019" class="csl-entry">
King, Andrew, and Robert Eckersley. 2019. <em>Statistics for Biomedical Engineers and Scientists</em>. Academic Press.
</div>
<div id="ref-Leonhart2013" class="csl-entry">
Leonhart, Rainer. 2013. <em>Lehrbuch Statistik. Einstieg Und Vertiefung</em>. Hans Huber.
</div>
<div id="ref-Realstat" class="csl-entry">
Mi, Charles, Wadi, James Lindsay, James, Junyu Chen, Richard, and Mathieu Le et al. Corre. 2022. <span>“Real Statistics Using Excel.”</span> <a href="https://www.real-statistics.com/non-parametric-tests/wilcoxon-signed-ranks-test/">https://www.real-statistics.com/non-parametric-tests/wilcoxon-signed-ranks-test/</a>.
</div>
<div id="ref-IPS10" class="csl-entry">
Moore, David S., George P. McCabe, and Bruce Craig. 2021. <em>Introduction to the Practice of Statistics</em>. 10th ed. Macmillan.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="grundlagen-der-inferenzstatistik.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="inferenz-für-qualitative-daten.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/05-infquantdata.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["statformulasbook.pdf", "statformulasbook.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"before": "<li><a href="...">Statistics Formulas R</a></li>n",
"after": "<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>n"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
